/*! SPWidgets v2.5.0 2015-01-10 | MIT | Copyright (c) 2015 Paul Tavares | http://purtuga.github.io/SPWidgets */

!function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O;!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(P){a=function(a){var b=function(){function b(a){return a&&"/"!==a.charAt(a.length-1)&&(a+="/"),a.indexOf("http")>-1?a:a=document.location.protocol+"//"+document.location.hostname+(80!==Number(document.location.port)&&Number(document.location.port)>0?document.location.port:"")+a}var c={};return function(d){var e="",f=!1,g="getSiteUrl(): Unable to determine site url from "+d;if(d||(d=document.location.href,f=!0),e=d,d.indexOf("?")>-1?e=d.substr(0,d.indexOf("?")):d.indexOf("#")>-1&&(e=d.substr(0,d.indexOf("#"))),!e)throw new Error(g);if(c[e])return c[e];if(f&&("undefined"!=typeof _spPageContextInfo&&_spPageContextInfo.webServerRelativeUrl&&(c[e]=_spPageContextInfo.webServerRelativeUrl),!c[e]&&"undefined"!=typeof L_Menu_BaseUrl&&L_Menu_BaseUrl&&(c[e]=L_Menu_BaseUrl),c[e]))return c[e]=b(c[e]),c[e];if(c[e]||a.ajax({type:"POST",cache:!1,async:!1,url:document.location.protocol+"//"+document.location.host+"/_vti_bin/Webs.asmx",data:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body><WebUrlFromPageUrl xmlns='http://schemas.microsoft.com/sharepoint/soap/' ><pageUrl>"+e+"</pageUrl></WebUrlFromPageUrl></soap:Body></soap:Envelope>",contentType:"text/xml; charset=utf-8",dataType:"xml",success:function(b){c[e]=a(b).find("WebUrlFromPageUrlResult").text()||""}}),!c[e])throw delete c[e],new Error(g);return c[e]=b(c[e]),c[e]||""}}();return b}(P),b=function(){var a=function(){var a={},b=function(a,c){return a?"undefined"==typeof c?b.get(a):b.set(a,c):void 0};return b.clear=function(b){delete a[b]},b.clearAll=function(){a={}},b.get=function(b){return a[b]},b.set=function(b,c){return a[b]=c,c},b.isCached=function(b){return a.hasOwnProperty(b)?!0:!1},b}();return a}(),c=function(a,b,c){var d=function(){var d=null,e=function(){d.apply(this,arguments)};return e.defaults={listName:"",webURL:"",cacheXML:!0,async:!0,completefunc:null},d=function(d){var f,g=a.extend({},e.defaults,d);return g.webURL?"/"!==g.webURL.charAt(g.webURL.length-1)&&(g.webURL+="/"):g.webURL=c(),g.webURL+="_vti_bin/Lists.asmx",g.cacheKey=g.webURL+"?List="+g.listName,g.isCached=b.isCached(g.cacheKey),g.cacheXML&&g.isCached?(f=b(g.cacheKey),a.isFunction(g.completefunc)&&f.then(function(a,b,c){g.completefunc(c,b)}),f):(g.isCached&&b.clear(g.cacheKey),f=a.Deferred(function(c){a.ajax({type:"POST",cache:!1,async:g.async,url:g.webURL,contentType:"text/xml;charset=utf-8",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetList xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+g.listName+"</listName></GetList></soap:Body></soap:Envelope>"}).done(function(b,d,e){c.resolveWith(a,[b,d,e]),a.isFunction(g.completefunc)&&g.completefunc(e,d)}).fail(function(){c.rejectWith(a,arguments),g.cacheXML&&b.clear(g.cacheKey)})}).promise(),g.cacheXML&&b(g.cacheKey,f),f)},e}();return d}(P,b,a),d=function(a){var b=function(b){var c=a(b),d=c.find("ErrorCode"),e=!1;return d.length?(d.each(function(){return"0x00000000"!==a(this).text()?(e=!0,!1):void 0}),e):c.find("faultcode").length?!0:!1};return b}(P),e=function(a,b,c,d){var e=function(){var e=null,f=function(){return e.apply(this,arguments)};return f.defaults={listName:"",webURL:"",cacheXML:!1,async:!0,completefunc:null},e=function(e){var g,h=a.extend({},f.defaults,e);return h.webURL?"/"!==h.webURL.charAt(h.webURL.length-1)&&(h.webURL+="/"):h.webURL=c(),h.webURL+="_vti_bin/Forms.asmx",h.cacheKey=h.webURL+"?List="+h.listName,h.isCached=b.isCached(h.cacheKey),h.cacheXML&&h.isCached?(g=b(h.cacheKey),a.isFunction(h.completefunc)&&g.then(function(a,b){h.completefunc(a,b)}),g):(g=a.Deferred(function(c){h.isCached&&b.clear(h.cacheKey),a.ajax({type:"POST",cache:!1,async:h.async,url:h.webURL,contentType:"text/xml;charset=utf-8",dataType:"xml",data:'<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetFormCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+h.listName+"</listName></GetFormCollection></soap:Body></soap:Envelope>",complete:function(e,f){return"error"===f||d(e)?(h.cacheXML&&b.clear(h.cacheKey),void c.rejectWith(a,[e,f])):(c.resolveWith(a,[e,f]),void(a.isFunction(h.completefunc)&&h.completefunc(e,f)))}})}).promise(),h.cacheXML&&b(h.cacheKey,g),g)},f}();return e}(P,b,a,d),f=function(a){var b=function(b){var c,d,e,f,g=a.extend({},{xDoc:null,nodeName:"",asJQuery:!1,cleanAttr:!0},b),h=g.xDoc.getElementsByTagName(g.nodeName);if(0===h.length&&"z:row"===g.nodeName&&(h=g.xDoc.getElementsByTagName("row")),0===h.length&&"rs:data"===g.nodeName&&(h=g.xDoc.getElementsByTagName("data")),g.asJQuery===!0)return a(h);for(d=[],c=function(a){var b,c,d,e=a.attributes,f={};for(c=0,d=e.length;d>c;c++)b=e[c].name,g.cleanAttr&&b.indexOf("ows_")>-1&&(b=b.replace("ows_","")),f[b]=e[c].value;return f.___xmlNode=a,f},e=0,f=h.length;f>e;e++)d.push(c(h[e]));return d};return b}(P),g=function(a,b,c,d,e){var f=function(){var f=null,g=function(){return f.apply(this,arguments)};return g.defaults={listName:"",webURL:"",viewName:"",CAMLViewFields:"",CAMLQuery:"",CAMLRowLimit:"",CAMLQueryOptions:"",operation:"GetListItems",cacheXML:!1,async:!0,completefunc:null,changeToken:""},f=function(f){var h,i=a.extend({},g.defaults,f);return i.webURL?"/"!==i.webURL.charAt(i.webURL.length-1)&&(i.webURL+="/"):i.webURL=c(),i.webURL+="_vti_bin/Lists.asmx",i.cacheKey=i.webURL+"?"+[i.listName,i.viewName,i.CAMLViewFields,i.CAMLQuery,i.CAMLRowLimit,i.CAMLQueryOptions,i.operation,i.changeToken].join("|"),i.isCached=b.isCached(i.cacheKey),i.cacheXML&&i.isCached?(h=b(i.cacheKey),a.isFunction(i.completefunc)&&h.then(function(a,b,c){i.completefunc(b,c,a)}),h):(i.isCached&&b.clear(i.cacheKey),h=a.Deferred(function(c){a.ajax({type:"POST",cache:!1,async:i.async,url:i.webURL,contentType:"text/xml;charset=utf-8",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><'+i.operation+' xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+i.listName+"</listName><viewName>"+(i.viewName||"")+"</viewName><query>"+(i.CAMLQuery||"<Query></Query>")+"</query><viewFields>"+(i.CAMLViewFields||"<ViewFields></ViewFields>")+"</viewFields><rowLimit>"+(i.CAMLRowLimit||0)+"</rowLimit><queryOptions>"+(i.CAMLQueryOptions||"<QueryOptions></QueryOptions>")+"</queryOptions>"+("GetListItemChangesSinceToken"===i.operation?"<changeToken>"+i.changeToken+"</changeToken>":"")+"</"+i.operation+"></soap:Body></soap:Envelope>",complete:function(f,g){var h=[];return"error"===g||e(f)?(i.cacheXML&&b.clear(i.cacheKey),c.rejectWith(a,[h,f,g]),void(a.isFunction(i.completefunc)&&i.completefunc(f,g,h))):(h=d({xDoc:f.responseXML,nodeName:"z:row"}),c.resolveWith(a,[h,f,g]),void(a.isFunction(i.completefunc)&&i.completefunc(f,g,h)))}})}).promise(),i.cacheXML&&b(i.cacheKey,h),h)},g}();return f}(P,b,a,f,d),h=function(a,b){var c=function(b){function c(a){var c,d,f,g="";for(c=0,d=a.length;d>c;c++){g="";for(f in a[c])a[c].hasOwnProperty(f)&&(g+='<Field Name="'+f+'">'+a[c][f]+"</Field>");g&&(e.push('<Method ID="'+b.counter+'" Cmd="'+b.updateType+'">'+g+"</Method>"),b.counter++)}}function d(c){var d,f,g="";for(d=0,f=c.length;f>d;d++)a.isArray(c[d])&&(g+='<Field Name="'+c[d][0]+'">'+c[d][1]+"</Field>");g&&(e.push('<Method ID="'+b.counter+'" Cmd="'+b.updateType+'">'+g+"</Method>"),b.counter++)}var e=[],f=typeof b.updates;return!b.updates&&b.ID&&b.valuepairs?(b.valuepairs.push(["ID",b.ID]),d(b.valuepairs)):"string"===f?e.push(b.updates):a.isArray(b.updates)&&b.updates.length&&(f=typeof b.updates[0],"object"===f?c(b.updates):"string"===f?e.push.apply(e,b.updates):a.isArray(b.updates[0])&&d(b.updates)),e},d=function(){var d=null,e=function(){return d.apply(this,arguments)};return e.defaults={listName:"",webURL:"",async:!0,completefunc:null,updates:"",updateType:"Update",updateOnError:"Continue"},d=function(d){var f=a.extend({},e.defaults,d,{counter:1});return f.webURL?"/"!==f.webURL.charAt(f.webURL.length-1)&&(f.webURL+="/"):f.webURL=b(),f.updateType=f.batchCmd||f.updateType,f._updates=c(f).join(""),/<\/Batch>/.test(f._updates)||(f._updates='<Batch OnError="Continue">'+f._updates+"</Batch>"),a.ajax({type:"POST",cache:!1,async:f.async,url:f.webURL+"_vti_bin/Lists.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/UpdateListItems")},contentType:"text/xml;charset=utf-8",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><UpdateListItems xmlns="http://schemas.microsoft.com/sharepoint/soap/"><listName>'+f.listName+"</listName><updates>"+f._updates+"</updates></UpdateListItems></soap:Body></soap:Envelope>",complete:function(b,c){a.isFunction(f.completefunc)&&f.completefunc.call(a,b,c)}})},e}();return d}(P,a),i=function(a){var b=function(b,c){var d,e,f,g,h,i,j={};if("object"==typeof b&&1===arguments.length&&(c=b.data,b=b.tmplt),j.response="",j.template="string"!=typeof b?String(a("<div/>").append(b).html()):b,j.tokens=j.template.match(/(\{\{.*?\}\})/g),a.isArray(c)||(c=c?[c]:[{}]),null!==j.tokens)for(f=0,g=c.length;g>f;f++){for(h=j.template,d=0,e=j.tokens.length;e>d;d++)j.tokens[d]=j.tokens[d].replace(/[\{\}]/g,""),i=c[f][j.tokens[d]]||"",a.isFunction(i)&&(i=i()),h=h.replace("{{"+j.tokens[d]+"}}",i);j.response+=h}else j.response=j.template;return j.response};return b}(P),j=function(a){var b=function(b,c,d){var e=0,f=a(b);return d||(d="height"),f.each(function(){var b=a(this).css(d,"");e<b.outerHeight(!0)&&(e=b.outerHeight(!0))}),e>0&&(c&&(e+=c),f.css(d,e)),b};return b}(P),k=function(a){var b=function(b){return a(b).each(function(){if(!a(this).hasClass("addHoverEffectDone")){a(this).addClass("addHoverEffectDone");var b=this;a(b).mouseenter(function(){a(b).toggleClass("ui-state-hover")}),a(b).mouseleave(function(){a(b).toggleClass("ui-state-hover")})}})};return b}(P),l='<div class="spwidget-board">\n    <div class="spwidget-board-settings" style="display:none;">\n        <div class=\'spwidget-board-settings-columns\'>Columns</div>\n        <div class="spwidget-board-column-list-cntr ui-widget-content ui-corner-all" style="display: none">\n            <div class="ui-state-default">\n                <span>\n                    <span class="spwidget-board-column-total"></span> \n                    <span class="spwidget-board-column-total-label">Selected.</span>\n                </span>\n                <button type="button" name="check" title="Check-Uncheck All">Check</button>\n                <button type="button" name="close" title="Close">Close</button>\n            </div>\n            <div class="spwidget-board-column-list">\n            </div>\n            <div class="ui-state-default">\n                <button type="button" name="apply">Apply</button>\n            </div>\n        </div>\n    </div>\n    <div class="spwidget-board-headers">\n        <div class="spwidget-board-headers-cntr">\n            <div class="spwidget-board-state ui-widget-content ui-corner-top">\n                <span class="spwidget-board-header-title"></span>\n                <span class="spwidget-state-item-stat-cntr">\n                    <span class="spwidget-item-stat ui-widget-content ui-corner-all spwidget-state-item-total">0</span>\n                </span>\n            </div>\n            <div style="clear:both;"></div>\n        </div>\n    </div>\n    <div style="clear:both;"></div>\n    <div class="spwidget-board-states">\n        <div class="spwidget-board-states-cntr">\n            <div class="spwidget-board-state ui-widget-content ui-corner-bottom"></div>\n            <div style="clear:both;"></div>\n        </div>\n    </div>\n    <div style="clear:both;"></div>\n</div>\n<div class="spwidget-item-template">\n    <div>\n        <div>#{{ID}}: {{Title}}</div>\n        <div class="ui-state-active ui-corner-all spwidget-board-item-actions">\n            <a class="spwidgets-board-action" href="javascript:" title="View Item" data-spwidgets_id="{{ID}}" data-spwidgets_board_action="view-item"><img src="/_layouts/images/icgen.gif" border="0"/></a>\n            <a class="spwidgets-board-action" href="javascript:" title="Edit Item" data-spwidgets_id="{{ID}}" data-spwidgets_board_action="edit-item"><img src="/_layouts/images/CMSEditSourceDoc.GIF" border="0"/></a>\n        </div>\n    </div>\n</div>\n',m=void 0,n=function(a,b,c,d,e,f,g,h,i,j,k){var l,m={};return m.maxColumns=20,m.defaults={list:"",field:"",CAMLQuery:"<Query></Query>",CAMLViewFields:"",fieldFilter:null,optionalLabel:"(none)",template:null,webURL:b(),showColPicker:!1,colPickerLabel:"Columns",colPickerVisible:[],colPickerCloseLabel:"Close",colPickerApplyLabel:"Apply",colPickerCheckLabel:"Check-Uncheck All",colPickerTotalLabel:"Selected.",colPickerMaxColMsg:"Can not exceed 10 columns!",colPickerMinColMsg:"Mininum of 2 required!",onGetListItems:null,onPreUpdate:null,onBoardCreate:null,height:null},l=function(b,l){var n=Array.prototype.slice.call(arguments,1),o=b;return a(b).each(function(){var b=a(this),p="string"==typeof l,q=b.hasClass("hasSPShowBoard"),r=null,s="",t=null;return q&&!p?this:p&&q&&!b.hasClass("loadingSPShowBoard")?(s=l.toLowerCase(),t=b.data("SPShowBoardOptions"),"refresh"===s?t._getListItems().then(function(){t.showItemsOnBoard({refresh:!0})}):"redraw"===s?t.setBoardColumnHeight():"setvisible"===s?t.setUserDefinedVisibleCol(n[1]):"setheight"===s?(t.height=n[1],t.setBoardColumnHeight()):"getcolumns"===s&&(o=t.getBoardColumnList()),this):b.hasClass("loadingSPShowBoard")?this:(r=a.extend({},m.defaults,l,{ele:b,states:[],statesMap:{},tmpltHeader:"",tmpltState:"",statesCntr:"",headersCntr:"",listItems:[],initDone:!1,formUrls:null,isStateRequired:!0,maxColumnVisible:10,showNumberOfColumns:10,getBoardStates:function(){return a.Deferred(function(d){c({listName:r.list,cacheXML:!0,async:!1,webURL:r.webURL,completefunc:function(c,f){var h=a(c.responseXML),i=h.find("Fields Field[StaticName='"+r.field+"']");if(!i.length){if(i=h.find("Fields Field[DisplayName='"+r.field+"']"),!i.length)return void d.rejectWith(b,["Field ("+r.field+") not found in list definition!",c,f]);r._origField=r.field,r.field=i.attr("StaticName")}switch("FALSE"===i.attr("Required")&&(r.isStateRequired=!1),i.attr("Type").toLowerCase()){case"choice":r.isStateRequired||(r.states.push({type:"choice",title:r.optionalLabel,name:r.optionalLabel}),r.statesMap[""]=r.states[r.states.length-1]),r.fieldFilter&&(r.fieldFilter=r.fieldFilter.split(/\,/)),i.find("CHOICES CHOICE").each(function(b){var c=a(this).text();if(!r.fieldFilter||a.grep(r.fieldFilter,function(a){return a===c}).length){if(b>=m.maxColumns){try{console.log("SPWIDGETS:BOARD:Warning: Can only build a max of "+m.maxColumns+" columns!")}catch(d){}return!1}r.states.push({type:"choice",title:c,name:c}),r.statesMap[c]=r.states[r.states.length-1]}}),d.resolveWith(r,[c,f]);break;case"lookup":r.fieldFilter||(r.fieldFilter="<Query></Query>"),e({listName:i.attr("List"),async:!0,cacheXML:!0,CAMLQuery:r.fieldFilter,webURL:r.webURL,CAMLRowLimit:m.maxColumns,CAMLViewFields:'<ViewFields><FieldRef Name="'+i.attr("ShowField")+'" /></ViewFields>',completefunc:function(c,e){if("error"===e)return void d.rejectWith(b,["Communications Error!",c,e]);var f,h=a(c.responseXML);return h.SPMsgHasError()?void d.rejectWith(b,[h.SPGetMsgError(),c,e]):(r.isStateRequired||(r.states.push({type:"lookup",title:r.optionalLabel,name:""}),r.statesMap[""]=r.states[r.states.length-1]),f=g({xDoc:c.responseXML,node:"z:row",asJQuery:!0}),f.each(function(b){if(b>=m.maxColumns){try{console.log("SPWIDGETS:BOARD:Warning: Can only build a max of "+m.maxColumns+" columns!")}catch(c){}return!1}var d=a(this),e=d.attr("ows_ID"),f=d.attr("ows_"+i.attr("ShowField")),g=e+";#"+f;r.states.push({type:"lookup",title:f,name:g}),r.statesMap[g]=r.states[r.states.length-1]}),void d.resolveWith(r,[c,e]))}});break;default:d.rejectWith(b,["Field ("+r.field+") Type ("+i.attr("Type")+") is not supported!",c,f])}}})}).promise()},_getListItems:function(){return a.Deferred(function(c){function d(d){a.isFunction(r.onGetListItems)&&r.onGetListItems.call(b,r.listItems,d),c.resolveWith(b,[r.listItems])}a.isFunction(r.CAMLQuery)?r.CAMLQuery.call(b,function(b){a.isArray(b)&&(r.listItems=b,d(r.CAMLQuery))},l):e({listName:r.list,async:!0,CAMLQuery:r.CAMLQuery,CAMLRowLimit:0,CAMLViewFields:r.CAMLViewFields,webURL:r.webURL,completefunc:function(e,f,g){if("error"===f)return void c.rejectWith(b,["Communications Error!",e,f]);var h=a(e.responseXML);return h.SPMsgHasError()?void c.rejectWith(b,[h.SPGetMsgError(),e,f]):(r.listItems=g,void d(h))}})}).promise()},getBoardItemDataObject:function(b){var c,d,e,f=null;if(b)for(b=String(b),c=0,d=r.listItems.length;d>c;c++)e=r.listItems[c].ID,a.isFunction(e)&&(e=r.listItems[c].ID()),e=String(e),b===e&&(f=r.listItems[c],c=d+d);return f},showItemsOnBoard:function(c){function d(c,d){var e="",f=null,i="";return a.isFunction(r.template)?(e=r.template.call(b,c,d),e&&(e=String(e))):e=h(r.template,s),void 0!==d&&""!==e?d.html(e):""!==e&&(f=c.ID,a.isFunction(c.ID)&&(f=c.ID()),void 0===m[o]&&(m[o]=""),r.initDone&&g.refresh&&(i+=" spwidget-temp"),m[o]+='<div class="spwidget-board-state-item ui-state-default ui-corner-all'+i+'" data-id="'+f+'">'+e+"</div>"),e}var e,f,g=a.extend({},{rows:r.listItems,refresh:!1,doBoardInsert:!0},c),i=[],k=[],l=[],m={},n=null,o=null,p=null,q=null,s=null;if(!g.refresh)for(e=0,f=r.states.length;f>e;e++)r.states[e].headerTotalEle.html("0"),r.states[e].dataEle.empty();for(e=0,f=g.rows.length;f>e;e++)s=g.rows[e],o=s[r.field]||"",p=s.ID,a.isFunction(o)&&(o=s[r.field]()),a.isFunction(p)&&(p=p()),r.statesMap[o]&&(g.refresh===!1?(r.initDone&&i.push(s),d(s)):(n=r.statesCntr.find("div[data-id='"+p+"']"),n.length?(n.addClass("spwidget-temp"),n.closest("div.spwidget-board-state").data("boardstate")!==o&&(n.appendTo(r.statesMap[o].dataEle),l.push(s)),d(s,n)):(r.initDone&&i.push(s),d(s))));if(g.doBoardInsert){for(e in m)m.hasOwnProperty(e)&&""!==m[e]&&r.statesMap[e].dataEle.append(m[e]);j(b.find(".spwidget-board-state-item"))}return r.initDone&&g.refresh&&r.statesCntr.find("div.spwidget-board-state-item").not("div.spwidget-temp").each(function(){k.push(r.getBoardItemDataObject(a(this).data("id"))),a(this).remove()}).end().removeClass("spwidget-temp"),r.initDone&&(r.statesCntr.find("div.spwidget-board-state").sortable("refresh").end().disableSelection(),q=r.getEventObject(),i.length&&(q.itemsModified.length=0,q.itemsModified.push(i),b.trigger("spwidget:boarditemadd",[b,a.extend({},q)])),k.length&&(q.itemsModified.length=0,q.itemsModified.push(k),b.trigger("spwidget:boarditemremove",[b,a.extend({},q)])),q.itemsModified.length=0,q.itemsModified.push.apply(q.itemsModified,i),q.itemsModified.push.apply(q.itemsModified,k),q.itemsModified.push.apply(q.itemsModified,l),q.itemsModified.length&&b.trigger("spwidget:boardchange",[b,q])),r.updBoardHeaders(),r.setBoardColumnHeight(),m},updBoardHeaders:function(b){var c,d,e=a.extend({},{state:null},b);if(e.state);else for(c=0,d=r.states.length;d>c;c++)r.states[c].headerTotalEle.html(r.states[c].dataEle.children().length)},getEventObject:function(b){b||(b=r.statesCntr.find("div.spwidget-board-state-item:first")),b=a(b);var c,d,e={stateTotals:{},itemTotal:0,currentState:b.closest("div.spwidget-board-state").data("boardstate"),itemObj:r.getBoardItemDataObject(b.data("id"))||{},itemsModified:[]};for(c=0,d=r.states.length;d>c;c++)e.itemTotal+=e.stateTotals[r.states[c].name]=Number(r.states[c].headerTotalEle.text());return e},getListFormUrl:function(b){function c(){d({listName:r.list,webURL:r.webURL,cacheXML:!0,async:!1,completefunc:function(b){a(b.responseXML).find("Form").each(function(){var b=a(this);r.formUrls[String(b.attr("Type")).toLowerCase()]=r.webURL+"/"+b.attr("Url")})}})}return b=String(b).toLowerCase(),null===r.formUrls&&(r.formUrls={},c()),r.formUrls[b]||""},setUserDefinedVisibleCol:function(b){function c(b){var c=!1;return a.each(r.states,function(a,d){return d.title===b||d.name===b?(c=!0,!1):void 0}),c}var d=0,e=!1;if(b){if(!a.isArray(b)||!b.length){if(!a.isArray(b)&&"all"!==String(b).toLowerCase())return;e=!0,b=[]}b.length<2||(e||(d=0,a.each(b,function(a,b){return c(b)&&d++,2===d?!1:void 0})),d=0,a.each(r.states,function(c,e){return a.inArray(e.title,b)>-1||a.inArray(e.name,b)>-1?(d++,e.isVisible===!1&&(e.isVisible=!0,e.dataEle.css("display",""),e.headerEle.css("display",""))):(e.isVisible=!1,e.dataEle.css("display","none"),e.headerEle.css("display","none")),d>=r.maxColumnVisible?!1:void 0}),r.setBoardColumnClass(d),r.setBoardColumnHeight(),r.triggerBoardColumnChangeEvent())}},setBoardColumnClass:function(b){var c=r.headersCntr.add(r.statesCntr);return b=parseInt(b),(!b||2>b)&&(b=0,a.each(r.states,function(a,c){c.isVisible&&b++})),r.showNumberOfColumns===b?r:(c.addClass("spwidget-states-"+b),r.showNumberOfColumns&&c.removeClass("spwidget-states-"+r.showNumberOfColumns),r.showNumberOfColumns=b,r)},triggerBoardColumnChangeEvent:function(){var b=[];r.initDone&&(a.each(r.statesMap,function(a,c){c.isVisible&&b.push(c.title)}),r.ele.trigger("spwidget:boardColumnChange",[r.ele,b]))},setupColumnPicker:function(){var c=b.find(".spwidget-board-column-list-cntr"),d=c.find("div.spwidget-board-column-list"),e=c.children("div.ui-state-default:last"),f={$totalCntr:c.find("span.spwidget-board-column-total")};f.setTotalSelected=function(){var a=f.getSelected().length;return f.$totalCntr.html(a),a},f.getSelected=function(){return d.find("a.ui-state-highlight")},f.showMessage=function(b){a('<div class="spwidget-board-msg ui-state-error ui-corner-all">'+b+"</div>").appendTo(e).fadeOut(8e3,function(){a(this).remove()})},f.setSelected=function(){var b=d.find("a");a.each(r.states,function(a,c){var d=b.filter("[data-board_col_index='"+a+"']");c.isVisible?f.selectColumn(d,!1):f.selectColumn(d,!0)}),f.setTotalSelected()},f.selectColumn=function(b,c){return a(b).each(function(){var b=a(this),d=b.find(".ui-icon");b.hasClass("ui-state-highlight")||c?c!==!1&&(d.removeClass("ui-icon-check"),b.removeClass("ui-state-highlight")):(d.addClass("ui-icon-check"),b.addClass("ui-state-highlight"))}),b},f.setVisibleColumns=function(b){b||(b=f.getSelected());var c=b.length;a.each(r.states,function(a,c){b.filter("[data-board_col_index='"+a+"']").length?c.isVisible===!1&&(c.isVisible=!0,c.dataEle.css("display",""),c.headerEle.css("display","")):(c.isVisible=!1,c.dataEle.css("display","none"),c.headerEle.css("display","none"))}),r.setBoardColumnClass(c),r.setBoardColumnHeight()},f.setUserDefinedVisibleCol=function(b){var c=0,e="";if(!a.isArray(b)||!b.length){if(!a.isArray(b)&&"all"!==String(b).toLowerCase())return;b=[],a.each(r.states,function(a,c){b.push(c.title)})}a.each(b,function(b,d){return a.each(r.states,function(a,b){return b.title===d?(c++,c>1&&(e+=","),e+="a[data-board_col_name='"+b.name+"']",!1):void 0}),c>=r.maxColumnVisible?!1:void 0}),c>=2&&(f.setVisibleColumns(d.find(e)),f.triggerEvent())},f.triggerEvent=r.triggerBoardColumnChangeEvent,c.find("button[name='apply']").button({label:r.colPickerApplyLabel,icons:{secondary:"ui-icon-circle-check"}}).on("click",function(){var a=f.getSelected(),b=a.length;return b>r.maxColumnVisible?void f.showMessage(r.colPickerMaxColMsg):2>b?void f.showMessage(r.colPickerMinColMsg):(c.hide(),f.setVisibleColumns(a),void f.triggerEvent())}),c.find("button[name='check']").attr("title",r.colPickerCheckLabel).button({text:!1,icons:{primary:"ui-icon-radio-off"}}).on("click",function(){var a=f.getSelected();a.length?f.selectColumn(a,!0):f.selectColumn(d.find("a")),f.setTotalSelected()}),c.find("button[name='close']").attr("title",r.colPickerCloseLabel).button({text:!1,icons:{primary:"ui-icon-circle-close"}}).on("click",function(){c.hide()}),b.find("div.spwidget-board-settings").css("display","").find("div.spwidget-board-settings-columns").each(function(){var b=a(this);return b.button({label:r.colPickerLabel,icons:{secondary:"ui-icon-triangle-1-s"}}).on("click.SPWidgets",function(){c.is(":visible")?c.hide():(f.setSelected(),c.show().position({my:"left top",at:"left bottom",of:b}))}),!1}),d.each(function(){var b=a(this),c="";return a.each(r.states,function(a,b){c+='<a href="javascript:" data-board_col_index="'+a+'" data-board_col_name="'+b.name+'"><span class="ui-icon ui-icon-minus"></span><span>'+b.title+"</span></a>"}),b.html(c),!1}).on("click","a",function(){f.selectColumn(this),f.setTotalSelected()}),c.find("span.spwidget-board-column-total-label").html(r.colPickerTotalLabel)},setBoardColumnHeight:function(){return r.headersCntr.is(":visible")&&i(r.headersCntr.find("div.spwidget-board-state:visible"),0,"min-height"),r.height?void r.statesCntr.find("div.spwidget-board-state:visible").css({height:r.height,"min-height":""}):void(r.statesCntr.is(":visible")&&i(r.statesCntr.find("div.spwidget-board-state:visible").css("height",""),20,"min-height"))},getBoardColumnList:function(){var a,b,c=[];for(a=0,b=r.states.length;b>a;a++)c.push({name:r.states[a].name,title:r.states[a].title,isVisible:r.states[a].isVisible});return c}}),r.list&&r.field?(b.addClass("loadingSPShowBoard").data("SPShowBoardOptions",r),r.getBoardStates().then(function(){""===r.CAMLViewFields?r.CAMLViewFields='<ViewFields><FieldRef Name="ID" /><FieldRef Name="Title" /><FieldRef Name="'+r.field+'" /></ViewFields>':r.CAMLViewFields.indexOf(r.field)<0&&(r.CAMLViewFields=r.CAMLViewFields.replace(/<\/ViewFields\>/i,'<FieldRef Name="'+r.field+'" /></ViewFields>')),b.html(a(k).filter("div.spwidget-board")),r.tmpltHeader=a("<div/>").append(b.find("div.spwidget-board-headers-cntr div.spwidget-board-state").clone()).html(),r.tmpltState=a("<div/>").append(b.find("div.spwidget-board-states-cntr div.spwidget-board-state")).html(),r.states.length<=r.maxColumnVisible&&(r.showNumberOfColumns=r.states.length),r.statesCntr=b.find("div.spwidget-board-states-cntr").addClass("spwidget-states-"+r.showNumberOfColumns).empty(),r.headersCntr=b.find("div.spwidget-board-headers-cntr").addClass("spwidget-states-"+r.showNumberOfColumns).empty(),a.each(r.states,function(b,c){c.headerEle=a(r.tmpltHeader).appendTo(r.headersCntr).attr("data-boardstate",c.name).attr("data-boardindex",b).find(".spwidget-board-header-title").html(c.title).end(),c.dataEle=a(r.tmpltState).appendTo(r.statesCntr).attr("data-boardindex",b).attr("data-boardstate",c.name),c.headerTotalEle=c.headerEle.find("span.spwidget-state-item-total"),c.isVisible=!0,b>r.maxColumnVisible-1&&(c.headerEle.css("display","none"),c.dataEle.css("display","none"),c.isVisible=!1)}),a(r.headersCntr,r.statesCntr).append('<div style="clear:both;"></div>'),r.showColPicker===!0&&r.setupColumnPicker(),a.isArray(r.colPickerVisible)&&r.colPickerVisible.length&&r.setUserDefinedVisibleCol(r.colPickerVisible),b.on("sortreceive sortremove",function(b,c){r.updBoardHeaders(),a(c.item).removeClass("ui-state-hover")}).on("sortreceive",function(c,d){var e=r.getEventObject(d.item),h=a.Deferred(),i="";return i=a.isFunction(e.itemObj.ID)?e.itemObj.ID():e.itemObj.ID,e.updates=[],e.updatePromise=h.promise(),e.updates.push([r.field,e.currentState]),a.isFunction(r.onPreUpdate)&&r.onPreUpdate.call(d.item,c,d.item,e)===!0?this:e.updates.length?void f({listName:r.list,async:!0,ID:i,valuepairs:e.updates,webURL:r.webURL,completefunc:function(f,i){if("error"===i)return void h.rejectWith(b,["Communications Error!",f,i]);var j=a(f.responseXML),k=null;return j.SPMsgHasError()?void h.rejectWith(b,[j.SPGetMsgError(),f,i]):(k=g({xDoc:f.responseXML,nodeName:"z:row"}),a(c.target).trigger("spwidget:boardchange",[d.item,e]),void h.resolveWith(c.target,[k[0],e.itemObj,f]))}}):this}).on("click","a.spwidgets-board-action",function(b){var c=a(b.currentTarget),d=String(c.data("spwidgets_board_action")).toLowerCase(),e="",f=encodeURIComponent(window.location.href);switch(d){case"edit-item":e=r.getListFormUrl("EditForm");break;case"view-item":e=r.getListFormUrl("DisplayForm")}return window.location.href=e+"?ID="+c.data("spwidgets_id")+"&Source="+f,this}),null===r.template&&(r.template=a(k).filter("div.spwidget-item-template")),r._getListItems().then(function(){r.showItemsOnBoard(),r.statesCntr.find("div.spwidget-board-state").each(function(){var c=a(this);c.sortable({connectWith:c.siblings(),containment:b,cursor:"move",tolerance:"pointer",opacity:".80",placeholder:"ui-state-highlight spwidget-board-placeholder",forcePlaceholderSize:!0,remove:function(){r.setBoardColumnHeight()}})}),r.statesCntr.disableSelection(),r.initDone=!0,r.setBoardColumnHeight(),b.addClass("hasSPShowBoard").removeClass("loadingSPShowBoard"),a.isFunction(r.onBoardCreate)&&r.onBoardCreate.call(b,r.getEventObject()),a(b).trigger("spwidget:boardcreate",[b,r.getEventObject()])})}).fail(function(a){b.append('<div class="ui-state-error"><p>'+a+"</p></div>")}),this):(b.html("<div>SPWidgets:Board [ERROR] Missing required input parameters!</div>"),this))}),o},l.defaults=m.defaults,l}(P,a,c,e,g,h,f,i,j,k,l),o='<div class="spwidget-date-cntr">\n    <div class="spwidget-date-selected-cntr" style="display:none;"></div>\n    <div class="spwidget-date-input-cntr">\n        <input class="spwidget-date-datepicker" name="SPDateFieldInput" value="" />\n    </div>\n</div>\n<div class="spwidget-datetime-selector ui-widget-content ui-corner-all">\n    <div class="spwidget-selectors">\n        <div class="spwidget-date-selector"></div>\n        <div class="spwidget-time-selector ui-widget-content ui-corner-all">\n            <div class="spwidget-time-selector-cntr">\n                <div class="ui-widget-header ui-helper-clearfix ui-corner-all">\n                    Time\n                </div>\n                <div class="spwidget-time-hour">\n                    <label>Hour</label>\n                    <select name="spwidget_hour" class="spwidget-hour">\n                        <option value="1"> 1</option>\n                        <option value="2"> 2</option>\n                        <option value="3"> 3</option>\n                        <option value="4"> 4</option>\n                        <option value="5"> 5</option>\n                        <option value="6"> 6</option>\n                        <option value="7"> 7</option>\n                        <option value="8"> 8</option>\n                        <option value="9"> 9</option>\n                        <option value="10">10</option>\n                        <option value="11">11</option>\n                        <option value="12">12</option>\n                    </select>\n                </div>\n                <div class="spwidget-time-min">   \n                    <label>Minutes</label>\n                    <select name="spwidget_min" class="spwidget-min">\n                        <option value="00">00</option>\n                        <option value="05">05</option>\n                        <option value="10">10</option>\n                        <option value="15">15</option>\n                        <option value="20">20</option>\n                        <option value="25">25</option>\n                        <option value="30">30</option>\n                        <option value="35">35</option>\n                        <option value="40">40</option>\n                        <option value="45">45</option>\n                        <option value="50">50</option>\n                        <option value="55">55</option>\n                    </select>\n                </div>\n                <div class="spwidget-time-ampm">\n                    <label>AM|PM</label>\n                    <select name="spwidget_ampm" class="spwidget-ampm">\n                        <option value="AM">AM</option>\n                        <option value="PM">PM</option>\n                    </select>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="spwidget-btn-set">\n        <div class="spwidget-btn">\n            Set\n        </div>\n    </div>\n</div>',p=function(){var a=function(a,b){function c(a){return 10>a?"0"+a:a
}b=String(b||"local").toLowerCase(),a=a||new Date;var d="";return d="utc"===b?a.getUTCFullYear()+"-"+c(a.getUTCMonth()+1)+"-"+c(a.getUTCDate())+"T"+c(a.getUTCHours())+":"+c(a.getUTCMinutes())+":"+c(a.getUTCSeconds())+"Z":a.getFullYear()+"-"+c(a.getMonth()+1)+"-"+c(a.getDate())+"T"+c(a.getHours())+":"+c(a.getMinutes())+":"+c(a.getSeconds())};return a}(),q=function(){var a=function(a){var b,c,d,e,f,g,h=null;if(!a)return h;if(h=Date.parse(10===a.length?a+"T00:00":a))return new Date(h);if(f=[1,4,5,6,7,10,11],b=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/,c=a.match(b),!c)return h;for(d=0,e=f.length;e>d;d++)c[f[d]]=~~c[f[d]];return--c[2],"Z"===c[8]?(void 0!==c[9]&&(g=60*c[10]+c[11],"+"===c[9]&&(g=-g),c[5]+=g),h=new Date(Date.UTC(c[1],c[2],c[3],c[4],c[5],c[6],c[7]))):h=new Date(c[1],c[2],c[3],c[4],c[5],c[6],c[7]),h};return a}(),r=void 0,s=function(a,b,c,d,e,f){var g,h={};return h.isInitDone=!1,h.evNamespace=".spwidgets.spdatefield",h.defaults={allowMultiples:!1,delimeter:";",remainOpen:!0,datepicker:{dateFormat:"mm/dd/yy",buttonImage:"/_layouts/images/CALENDAR.GIF",showOn:"both",buttonImageOnly:!0},dateTemplate:'{{date}} <span class="spwidgets-item-remove">[x]</span>',showTimepicker:!1,timeFormat:" {{hour}}:{{minutes}} {{ampm}}",timeUTC:!0,labelHour:"Hour",labelMinutes:"Minutes",labelAMPM:"AM|PM",labelTime:"Time",labelSet:"Set",onSelect:null},g=function(g,i){var j=Array.prototype.slice.call(arguments,1),k=g;return h.isInitDone||(h.isInitDone=!0,a("body").on("click"+h.evNamespace,h.onPageClick)),"string"==typeof i?function(){var b=String(j[0]).toLowerCase(),c=k;return a(k).each(function(d,e){if(a(k).hasClass("hasSPDateField")){var f=a(e),g=f.data("SPDateFieldInstance");if(g&&f.length>0)switch(b){case"getdate":c=g.getDate();break;case"setdate":j[1]&&g.setDate({date:j[1],format:j[2]||g.opt.datepicker.dateFormat});break;case"removedate":j[1]&&g.removeDate({date:j[1],format:j[2]||g.opt.datepicker.dateFormat});break;case"reset":g.reset();break;case"destroy":g.destroy()}}}),c}():a(g).each(function(){var g={$ele:a(this).addClass("hasSPDateField"),isInline:!1,inlineCntr:null};if(!g.$ele.is("input[type='text']")){if(g.$ele.is(":input"))return this;g.isInline=!0,g.inlineCntr=a(this),g.$ele=a('<input name="spdatefieldinline" value="" type="text" style="display:none" />')}return g.opt=a.extend(!0,{},h.defaults,i),g.$ui=a(b).filter("div.spwidget-date-cntr").clone(),g.isInline?(g.$ui.appendTo(g.inlineCntr).addClass("spwidget-inline").css("display","none"),g.$ele.appendTo(g.$ui)):g.$ui.insertAfter(g.$ele).css("display","none"),g.eleOrigVal=g.$ele.val(),g.$ele.val(""),g.$input=g.$ui.find("input[name='SPDateFieldInput']").val(g.$ele.val()),g.$inputCntr=g.$input.closest(".spwidget-date-input-cntr"),g.$dtCntr=g.$ui.find("div.spwidget-date-selected-cntr"),g.getDate=function(){var a={input:g.$ele.val(),dates:[]};return a.input&&(g.opt.allowMultiples?a.dates=a.input.split(g.opt.delimeter):a.dates.push(a.input)),a},g.reset=function(){return g.$input.val("").datepicker("hide"),g.$ele.val("").change(),g.$dtCntr.empty(),g},g.setDate=function(b){var f,h=a.extend({},{date:"",time:"",format:g.opt.datepicker.dateFormat,setDatepicker:!0,triggerEvent:!0},b),i=g.$ele.val(),j="";return h.date?(a.isArray(h.date)||(h.date=[h.date]),a.each(h.date,function(b,k){var l=k,m="",n="";if(!(l instanceof Date))if(l=String(l),l.indexOf("T")>-1)l=e(l);else try{l=a.datepicker.parseDate(h.format,k)}catch(o){return g}f=l,m=a.datepicker.formatDate("yy-mm-dd",l),n=a.datepicker.formatDate(g.opt.datepicker.dateFormat,l),g.opt.showTimepicker&&(m=d(l,g.opt._timeFmt),n+=g.$timepicker.formatTime(l)),g.opt.allowMultiples?i.indexOf(m)<0&&(i&&(i+=g.opt.delimeter),i+=m,j+='<span class="spwidgets-item" data-spwidget_dt1="'+m+'" data-spwidget_dt2="'+n+'">'+c({tmplt:g.opt.dateTemplate,data:{date:n}})+" </span>"):(i=m,j=n)}),g.opt.allowMultiples?g.$dtCntr.append(j):h.setDatepicker&&(g.$input.val(j),g.isInline&&!g.opt.showTimepicker?g.$inputCntr.datepicker("setDate",f):g.isInline&&g.$timepicker.updateDateTimeWidgets(f)),g.$ele.val(i),h.triggerEvent&&(g.isInline||g.$ele.change(),a.isFunction(g.opt.onSelect)&&g.opt.onSelect.call(g.isInline?g.inlineCntr:g.$ele)),g):g},g.removeDate=function(b){var c=a.extend({},{date:"",format:g.opt.datepicker.dateFormat},b),e=g.getDate();return c.date?(a.isArray(c.date)||(c.date=[c.date]),a.each(c.date,function(b,f){var h=f,i="",j="";if(!(h instanceof Date))try{h=a.datepicker.parseDate(c.format,f)}catch(k){return g}i=g.opt.showTimepicker?d(h,g.opt._timeFmt):a.datepicker.formatDate("yy-mm-dd",h),j=new RegExp("("+g.opt.delimeter+")?"+i,"g"),e.input=e.input.replace(j,""),g.opt.allowMultiples&&g.$dtCntr.find("span[data-spwidget_dt1='"+i+"']").remove()}),e.input=e.input.replace(new RegExp("^"+g.opt.delimeter),"").replace(new RegExp(g.opt.delimeter+"$"),""),g.$ele.val(e.input).change(),g):g},g.destroy=function(){g.$ele.removeData("SPDateFieldInstance"),g.$ele.removeClass("hasSPDateField").css("display",""),g.$ui.css("display","none"),g.$input.datepicker("hide"),g.$input.datepicker("destroy"),g.$timepicker&&(g.$timepicker.$timePicker.off(".spdatefield"),g.$input.off(".spdatefield")),g.isInline&&g.inlineCntr.removeClass("hasSPDateField").removeData("SPDateFieldInstance"),g.$ui.remove()},g.createDatePicker=function(){var d={};return g.opt.showTimepicker?(d.$selectorCntr=a(b).filter("div.spwidget-datetime-selector").clone().appendTo(g.$inputCntr).css("display","none"),d.$datePicker=d.$selectorCntr.find("div.spwidget-date-selector"),d.$timePicker=d.$selectorCntr.find("div.spwidget-time-selector"),d.$setButton=d.$selectorCntr.find("div.spwidget-btn-set"),d.$hourSelect=d.$timePicker.find("select.spwidget-hour"),d.$minSelect=d.$timePicker.find("select.spwidget-min"),d.$ampmSelect=d.$timePicker.find("select.spwidget-ampm"),d.heightDone=!1,d.firstShowDone=!1,d.getTime=function(){var a={hour:d.$hourSelect.val(),minutes:d.$minSelect.val(),ampm:d.$ampmSelect.val()};return a.hour24=a.hour,"PM"===a.ampm&&"12"!==a.hour?a.hour24=String(parseInt(a.hour)+12):"AM"===a.ampm&&"12"===a.hour&&(a.hour24="0"),a},d.formatTime=function(a){var b=a,e="";return a instanceof Date?(b={hour:a.getHours(),hour24:String(a.getHours()),minutes:String(a.getMinutes()),ampm:"AM"},b.hour>12?(b.hour=String(b.hour-12),b.ampm="PM"):12===b.hour&&(b.ampm="PM"),b.hour=String(b.hour),"0"===b.hour&&(b.hour="12"),String(b.minutes).length<2&&(b.minutes="0"+b.minutes)):a||(b=d.getTime()),e=c(g.opt.timeFormat,b)},d.setDateTime=function(a){var b=d.getTime();a instanceof Date||(a=d.$datePicker.datepicker("getDate"),null===a&&(a=new Date)),a.setHours(b.hour24),a.setMinutes(b.minutes),g.setDate({date:a,format:g.opt.datepicker.dateFormat,setDatepicker:!0}),d.execUsersCallback(g.$input.val())},d.updateDateTimeWidgets=function(a){var b,c=a;for(c instanceof Date||(c=new Date),b=c.getHours(),0===b?b="12":b>12&&(b-=12),d.$hourSelect.val(b),b=c.getMinutes();b%5;)--b;10>b&&(b="0"+b),d.$minSelect.val(b),d.$ampmSelect.val(c.getHours()>11?"PM":"AM"),d.$datePicker.datepicker("setDate",c)},d.showPicker=function(){d.$selectorCntr.show(function(){var a;d.heightDone||(d.heightDone=!0,f(d.$datePicker.find("div.ui-datepicker-inline").add(d.$timePicker))),d.firstShowDone||(d.firstShowDone=!0,a=g.getDate(),a=a.dates.length?e(a.dates[a.dates.length-1]):new Date,d.updateDateTimeWidgets(a))}).position({my:"left top",at:"left bottom",of:g.$input})},d.execUsersCallback=function(b,c){a.isFunction(g.opt.datepicker._onSelect)&&g.opt.datepicker._onSelect.call(d.$datePicker,b,c)},g.opt.datepicker.altFormat="",g.opt.datepicker.altField="",g.opt.datepicker.buttonImage&&!g.isInline&&a('<img class="ui-datepicker-trigger" src="'+g.opt.datepicker.buttonImage+'" alt="..." title="...">').appendTo(g.$inputCntr).on("click"+h.evNamespace,function(){d.showPicker()}),(g.opt.allowMultiples||g.isInline)&&(d.$selectorCntr.addClass("spwidget-date-multiples-cntr"),d.$setButton.find("div.spwidget-btn").button({label:g.opt.labelSet}).on("click"+h.evNamespace,function(){return d.setDateTime(),this})),d.$timePicker.find("div.ui-widget-header").html(g.opt.labelTime).end().find("div.spwidget-time-hour > label").html(g.opt.labelHour).end().find("div.spwidget-time-min > label").html(g.opt.labelMinutes).end().find("div.spwidget-time-ampm > label").html(g.opt.labelAMPM).end(),a.isFunction(g.opt.datepicker.onSelect)&&(g.opt.datepicker._onSelect=g.opt.datepicker.onSelect),g.opt.datepicker.numberOfMonths=1,g.opt.datepicker.onSelect=function(a,b){if(g.opt.allowMultiples||g.isInline)return this;var c=new Date(b.currentYear,b.currentMonth,b.currentDay);d.setDateTime(c)},d.$datePicker.datepicker(g.opt.datepicker),d.$timePicker.on("change"+h.evNamespace+" keyup"+h.evNamespace,"select",function(a){return a.stopPropagation(),a.preventDefault(),g.opt.allowMultiples||g.isInline?this:(d.setDateTime(),this)}),g.isInline&&(g.$input.css("display","none"),d.$selectorCntr.addClass("spwidget-inline").css("display","")),g.isInline||g.$input.on("focus"+h.evNamespace,function(){d.showPicker()})):(g.opt.allowMultiples&&g.opt.remainOpen&&(g.opt.datepicker.showAnim=""),a.isFunction(g.opt.datepicker.onSelect)&&(g.opt.datepicker._onSelect=g.opt.datepicker.onSelect),g.opt.datepicker.onSelect=function(b,c){g.setDate({date:b,format:c.settings.dateFormat,setDatepicker:!1}),a.isFunction(g.opt.datepicker._onSelect)&&g.opt.datepicker._onSelect.call(this,b,c),g.opt.allowMultiples&&g.$input.val(""),g.opt.allowMultiples&&g.opt.remainOpen&&!g.isInline&&setTimeout(function(){g.$input.datepicker("show")},5)},g.isInline?(g.$inputCntr.datepicker(g.opt.datepicker),g.$input.css("display","none")):g.$input.datepicker(g.opt.datepicker)),d},g.opt._timeFmt=g.opt.timeUTC?"utc":"local",g.opt.datepicker.altFormat="yy-mm-dd",g.opt.datepicker.altField=g.$ele,g.opt.allowMultiples&&(g.opt.datepicker.altFormat="",g.opt.datepicker.altField="",g.$dtCntr.css("display","").on("click",".spwidgets-item-remove",function(b){var c=a(b.target).closest(".spwidgets-item"),d=c.data("spwidget_dt1");g.opt.allowMultiples&&(d=e(d)),g.removeDate({date:d,format:"yy-mm-dd"})})),g.$ele.css("display","none").data("SPDateFieldInstance",g),g.isInline&&g.inlineCntr.data("SPDateFieldInstance",g),g.$timepicker=g.createDatePicker(),g.eleOrigVal&&g.setDate({date:g.eleOrigVal.split(g.opt.delimeter),format:"yy-mm-dd",triggerEvent:!1}),g.$input.on("change",function(a){a.stopPropagation(),g.$ele.change()}),g.$ui.css("display",""),this})},h.onPageClick=function(b){var c=a(b.target),d=a("div.spwidget-datetime-selector:visible:not('.spwidget-inline')"),e=null;return a.contains(document.documentElement,c[0])?(d.length&&(e=c.closest("div.spwidget-datetime-selector"),!e.length&&c.is("input.spwidget-date-datepicker,.ui-datepicker-trigger")&&(e=c.parent().find("div.spwidget-datetime-selector")),d.not(e).hide()),this):this},g.defaults=h.defaults,g}(P,o,i,p,q,j),t='<div>\n    <div class="spwidgets-lookup-cntr">\n        <div class="spwidget-lookup">\n            <div class="spwidgets-lookup-selected" style="display:none;">\n            </div>\n            <div class="spwidgets-lookup-input">\n                <label>Add</label>\n                <input type="text" name="spwidgetLookupInput" value="" />\n                <span class="spwidget-lookup-selector-showhide" title="Browse">Browse</span>\n                <div class="spwidget-lookup-selector-cntr ui-widget-content">\n                    <div class="ui-state-default">\n                        <button type="button" name="close" title="Close">Close</button>\n                    </div>\n                    <div class="spwidget-lookup-selector-item-cntr"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n',u=function(a){var b=function c(b){var d,e=a.extend({},{type:"AND",values:[],onEachValue:null},b),f="<And>",g="</And>",h="",i=0,j=0,k=!1,l="",m=0;for(e.type=String(e.type).toUpperCase(),a.isArray(e.values)||(e.values=[e.values]),"AND"!==e.type&&(f="<Or>",g="</Or>"),i=e.values.length,j=i-1,k=a.isFunction(e.onEachValue),d=0;i>d;d++)if(l="",l+=k?String(e.onEachValue(e.values[d])).toString():String(e.values[d]).toString(),l&&(h+=l,m++,j-d>1)){l=c(a.extend({},e,{values:e.values.slice(d+1,i-d)})),l&&(m++,h+=l);break}return m>1&&(h=f+h+g),h};return b}(P),v=function(){var a=function(a){var b,c,d,e=[],f=String(a).split(";#"),g=f.length;if(void 0===a)return e;for(b=0;g>b;b++)c=f[b],b++,d=f[b],(c||d)&&e.push({id:c,title:d});return e};return a}(),w=function(){var a={escape:function(a){return"string"!=typeof a?"":a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")},unescape:function(a){return"string"!=typeof a?"":a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&apos;/g,"'").replace(/&quot;/g,'"')}};return a}(),x=void 0,y=function(a,b,c,d,e,f,g,h){var i,j={_isLookupbodyEventDone:!1};return j.defaults={list:"",allowMultiples:!0,inputLabel:"",inputPlaceholder:"Type and Pick",readOnly:!1,exactMatch:!0,uiContainer:null,selectFields:["Title"],filter:"",filterFields:["Title"],filterOrderBy:"",template:'<div>{{Title}} <span class="spwidgets-item-remove">[x]</span></div>',listTemplate:"{{Title}}",listHeight:0,onItemAdd:null,onItemRemove:null,onReady:null,msgNoItems:"",maxResults:50,minLength:2,hideInput:!0,padDelimeter:!1,showSelector:!1},i=function(f,h){var i=Array.prototype.slice.call(arguments,1);return a(f).each(function(){var f,k=a(this);if(!k.is("input")&&!k.is("textarea")||k.hasClass("hasLookupSPField")){if("string"==typeof h&&k.is("input")&&(f=k.data("SPWidgetLookupFieldUI").data("SPWidgetLookupFieldOpt"),"method"===h.toLowerCase())){var l=String(i[1]||"").toLowerCase(),m=i[2];"clear"===l?(a.isArray(m)||(m=m?[m]:[]),m.length?!function(){var b=a();a.each(m,function(a,c){b=b.add(f._selectedItemsCntr.find("div.spwidgets-item-id-"+c))}),j.removeItem(f,b)}():j.removeItem(f,f._selectedItemsCntr.find("div.spwidgets-item"))):"add"===l&&j.addItem(f,m)}return this}f=a.extend({},j.defaults,h,{_ele:k.css("display","none").addClass("hasLookupSPField")}),f.showSelectedItems=function(b,c){var e=f._selectedItemsCntr.css("display",""),g=[],h=!1;e.find("div.spwidgets-item").length&&f.allowMultiples!==!1||e.empty(),a.isArray(b)?g=b:g.push(b),a.each(g,function(b,g){if(!e.find("div.spwidgets-item-id-"+g.ID).length){var i=a('<div class="spwidgets-item spwidgets-item-id-'+g.ID+'" data-spid="'+g.ID+'" style="display:none">'+d(f.template,g)+"</div>").appendTo(e).find(".spwidgets-item-remove").on("click.SPWidgets",function(){j.removeItem(f,this)}).end();a.isFunction(f.onItemAdd)&&c!==!0&&f.onItemAdd.call(f._ele,i,g,f._cntr),e.find("div.spwidgets-item-id-"+g.ID).length>0&&(h=!0,i.fadeIn("slow").promise().then(function(){a(this).css("display","")}),c!==!0&&f.storeItemIDs(g.ID,f.allowMultiples),f.allowMultiples===!1&&f.hideInput===!0&&f._lookupInputEleCntr.css("display","none"))}}),f.readOnly&&f._cntr.find(".spwidgets-item-remove").remove(),h&&f._ele.trigger("change")},f.storeItemIDs=function(b,c){var d=a.trim(f._ele.val()),e=!1;a.isArray(b)||(b=[b]),c!==!0&&(d=""),a.each(b,function(a,b){b&&(d.length<1&&f.padDelimeter===!0&&!e&&(d+=";#",e=!0),d.length>0&&(d+=";#"),d+=b+";#")}),f._ele.val(d)},f.showCurrentInputSelection=function(b){return a.Deferred(function(d){var h=a.extend({},{async:!0},b),i=g(f._ele.val());return i.length?void c({operation:"GetListItems",async:h.async,listName:f.list,CAMLQuery:"<Query><Where>"+e({type:"OR",values:i,onEachValue:function(a){var b="";return a.id&&(b="<Eq><FieldRef Name='ID'/><Value Type='Counter'>"+a.id+"</Value></Eq>"),b}})+"</Where></Query>",CAMLViewFields:"<ViewFields>"+f._selectFields+"</ViewFields>",CAMLRowLimit:0,completefunc:function(a,b,c){f.addToAutocompleteCache(c),f.showSelectedItems(c,!0),d.resolveWith(f,[a,b])}}):void d.resolveWith(f,[null,null])}).promise()},f.getItemObjectFromCache=function(b){var c=null;return a.each(f._autocompleteCache,function(d,e){return a.each(e,function(a,d){return d.ID===b?(c=d,!1):void 0}),null!==c?!1:void 0}),c},f.addToAutocompleteCache=function(b){a.isArray(b)||(b=[b]),a.each(b,function(a,b){f._autocompleteCache[b.ID]||(f._autocompleteCache[b.ID]=[]),f._autocompleteCache[b.ID].push(b)})},f._cntr=a(b).find(".spwidgets-lookup-cntr").clone(1),null===f.uiContainer?f._cntr.insertAfter(f._ele):f._cntr.appendTo(a(f.uiContainer)),f._selectedItemsCntr=f._cntr.find("div.spwidgets-lookup-selected"),f._lookupInputEleCntr=f._cntr.find("div.spwidgets-lookup-input"),f._lookupInputEle=f._lookupInputEleCntr.find("input[name='spwidgetLookupInput']"),f._ignoreKeywordsRegEx=/^(of|and|a|an|to|by|the|or)$/i,f._cntr.data("SPWidgetLookupFieldOpt",f),f._ele.data("SPWidgetLookupFieldUI",f._cntr),f.showSelector?(f._selectorCntr=f._cntr.find("div.spwidget-lookup-selector-cntr"),f._queryInitDone=!1,f._cntr.find(".spwidget-lookup-selector-showhide").on("click",function(){f._selectorCntr.is(":visible")?f._selectorCntr.css("display","none"):(f._selectorCntr.css("display","block").position({my:"left top",at:"left bottom",of:f._lookupInputEle}),f._queryInitDone||(f._queryInitDone=!0,j.doSelectorDataInit(f)))}),f._selectorCntr.find("button[name='close']").button({text:!1,icons:{primary:"ui-icon-circle-close"}}).click(function(){f._selectorCntr.css("display","none")}),f._lookupInputEle.on("focus",function(){f._selectorCntr.is(":visible")&&f._selectorCntr.css("display","none")})):f._cntr.find(".spwidget-lookup-selector-showhide,.spwidget-lookup-selector-cntr").remove(),f.inputLabel?f._cntr.find("div.spwidgets-lookup-input label").empty().append(f.inputLabel):f._cntr.find("div.spwidgets-lookup-input label").remove(),f.inputPlaceholder&&f._lookupInputEleCntr.find("input").attr("placeholder",f.inputPlaceholder),f.readOnly===!0&&(f._lookupInputEleCntr.css("display","none"),f._cntr.find("div.spwidget-lookup").addClass("spwidget-lookup-readyonly")),f._selectFields="",a.each(f.selectFields,function(a,b){f._selectFields+="<FieldRef Name='"+b+"'/>"}),f._templateTokens=String(f.template).match(/(\$\{.*?\})/g),null==f._templateTokens&&(f._templateTokens=[]),a.each(f._templateTokens,function(a,b){f._templateTokens[a]=b.replace(/[\$\{\}]/g,"")});var n=f._autocompleteCache={};return f._cntr.find("div.spwidgets-lookup-input input").autocomplete({minLength:2,appendTo:f._cntr,open:function(){a(this).autocomplete("widget").each(function(){return f.listHeight>0&&a(this).css("height",f.listHeight+"px"),!1})},source:function(b,g){b.term=a.trim(b.term);var h=String(a.trim(b.term)).toUpperCase();if(h in n)return void g(n[h]);n[h]=[];var i=[],j=String(b.term);if(null===j.match(/\D/)&&null!==j.match(/\d/))i.push("<Eq><FieldRef Name='ID'/><Value Type='Counter'>"+j+"</Value></Eq>");else{var k=[b.term];f.exactMatch||(k=String(b.term).split(/ /));for(var l=0,m=f.filterFields.length;m>l;l++){for(var o=[],p=0,q=k.length;q>p;p++)f._ignoreKeywordsRegEx.test(k[p])||o.push("<Contains><FieldRef Name='"+f.filterFields[l]+"'/><Value Type='Text'>"+k[p]+"</Value></Contains>");i.push(e({values:o,type:"AND"}))}}var r=e({values:i,type:"OR"});f.filter&&(r=e({values:[r,f.filter],type:"AND"})),c({operation:"GetListItems",listName:f.list,async:!0,CAMLQuery:"<Query><Where>"+r+"</Where>"+f.filterOrderBy+"</Query>",CAMLRowLimit:f.maxResults,CAMLViewFields:"<ViewFields>"+f._selectFields+"</ViewFields>",completefunc:function(b,c,e){a.each(e,function(a,b){b.value="",b.label=d(f.listTemplate,b),n[h].push(b)}),g(n[h])}})},select:function(a,b){f.showSelectedItems(b.item)}}).on("keyup.SPWidgets",function(b){if(13===b.which){var c=a(b.target).val();c&&String(c).length<f.minLength&&a(b.target).autocomplete("search",c+"    ")}}),f._ele.val()?f.showCurrentInputSelection().then(function(){a.isFunction(f.onReady)&&f.onReady.call(f._ele,f._cntr)}):a.isFunction(f.onReady)&&f.onReady.call(f._ele,f._cntr),this})},j.removeItem=function(b,c){var d=a(c).closest("div.spwidgets-item"),e=b._selectedItemsCntr,f=[];if(a.isFunction(b.onItemRemove)){if(d.each(function(){f.push(b.getItemObjectFromCache(a(this).data("spid")))}),b.onItemRemove.call(b._ele,d,f,b._cntr)===!1)return j;f=[]}return d.fadeOut("fast").promise().then(function(){d.remove(),!b.msgNoItems&&(b.allowMultiples===!1||b.allowMultiples===!0&&e.find("div.spwidgets-item").length<1)&&e.css("display","none"),b.allowMultiples===!1&&b.hideInput===!0&&b._lookupInputEleCntr.css("display",""),e.find("div.spwidgets-item").length<1&&b.msgNoItems&&e.append("<div>"+b.msgNoItems+"</div>"),e.find("div.spwidgets-item").each(function(){f.push(a(this).data("spid"))}),b._lookupInputEleCntr.find("input").focus(),b.storeItemIDs(f),b._ele.change()}),j},j.addItem=function(a,b){if(!b||"string"!=typeof b)return a;var c=a._ele.val();return""===c&&a.padDelimeter===!0&&(c+=";#"),c&&(c+=";#"),c+=b,a._ele.val(c),a.showCurrentInputSelection(),a},j.doSelectorDataInit=function(b){var e={$resultsCntr:b._selectorCntr.find("div.spwidget-lookup-selector-item-cntr"),nextPageToken:"",isLoading:!1,hasMorePages:!0,$lastPage:a(),queryXml:b.filter?"<Query><Where>"+b.filter+"</Where>"+b.filterOrderBy+"</Query>":"<Query>"+b.filterOrderBy+"</Query>"};return j._isLookupbodyEventDone||(j._isLookupbodyEventDone=!0,a("body").on("click",function(b){var c=a(b.target),d=a("div.spwidget-lookup-selector-cntr:visible"),e=null;d.length&&(e=c.closest("div.spwidget-lookup-selector-cntr"),!e.length&&c.is(".spwidget-lookup-selector-showhide")&&(e=c.parent().find("div.spwidget-lookup-selector-cntr")),d.not(e).hide())})),e.getListRows=function(){return a.Deferred(function(g){if(e.isLoading)return void g.resolveWith(a,[e.$lastPage]);e.isLoading=!0;var i=a("<div/>").insertBefore(e.$nextPage);e.$lastPage=i,c({operation:"GetListItems",listName:b.list,async:!0,CAMLQuery:e.queryXml,CAMLRowLimit:b.maxResults,CAMLViewFields:"<ViewFields>"+b._selectFields+"</ViewFields>",CAMLQueryOptions:function(){return""!==e.nextPageToken?"<QueryOptions><Paging ListItemCollectionPositionNext='"+h.escape(e.nextPageToken)+"'/></QueryOptions>":void 0}(),completefunc:function(c,h,j){var k=f({xDoc:c.responseXML,nodeName:"rs:data",asJQuery:!0}).eq(0),l="";e.nextPageToken=k.attr("ListItemCollectionPositionNext")||"",""===e.nextPageToken&&(e.hasMorePages=!1),a.each(j,function(a,c){b.addToAutocompleteCache(c),c.value="",c.label=d(b.listTemplate,c),l+='<div class="spwidget-lookup-item" data-spwidgetsindex="'+a+'">'+c.label+"</div>"}),i.html(l).find("div.spwidget-lookup-item").each(function(){var b=a(this);b.hover(function(){b.addClass("ui-state-hover")},function(){b.removeClass("ui-state-hover")})}).end().on("click","div.spwidget-lookup-item",function(){var c=a(this).data("spwidgetsindex");b.showSelectedItems(j[c])}),e.isLoading=!1,g.resolveWith(i,[i])}})})},e.$nextPage=a('<div class="ui-state-highlight spwidget-lookup-selector-next">Next...</div>').appendTo(e.$resultsCntr.empty()).click(function(){e.hasMorePages&&(e.$nextPage.css("display","none"),e.getListRows().then(function(a){e.hasMorePages?e.$nextPage.css("display",""):a.children().length||a.append("<div class='ui-state-highlight'>No Items Found!</div>"),e.$resultsCntr.scrollTop(a.position().top)}))}),e.$nextPage.click(),b},i.defaults=j.defaults,i}(P,t,g,i,u,f,v,w),z='<!--\r\n    Html Templates for the PickSPUser plugin.\r\n    \r\n    |\r\n    |   $Author$\r\n    | $Revision$\r\n    |     $Date$\r\n    |       $Id$\r\n    |\r\n-->\r\n<div>\r\n    <div class="pt-pickSPUser">\r\n        <div class="pt-pickSPUser-selected">\r\n            None Selected!\r\n        </div>\r\n        <div style="clear:both"></div>\r\n        <div class="pt-pickSPUser-input" \r\n                title="Type user name above to view search results.">\r\n            <input name="pickSPUserInputField" value="" type="text"/>\r\n        </div>\r\n    </div>\r\n    \r\n    <div class="pt-pickSPUser-person">\r\n        <div class="pt-pickSPUser-person-cntr ui-state-default ui-corner-all">\r\n            <span class="pt-person-name"></span>\r\n            <div class="pt-pickSPUser-person-actions">\r\n                <div class="tt-record-item-action-links">\r\n                    <a class="tt-delete-icon" href="javascript:" onclick="jQuery.pt.pickSPUser.removeUser(this);">\r\n                        <img style="border: medium none; margin-right: 2px;" alt="Delete" src="/_layouts/images/delitem.gif">\r\n                    </a>\r\n                    <div style="clear:both;"></div>\r\n                </div>\r\n                <div style="clear:both;"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n',A=function(a,b,c,d){var e=function(){var e=null,f=function(){return e.apply(this,arguments)};return f.defaults={searchText:"",maxResults:50,principalType:"All",webURL:"",cacheXML:!1,async:!0,completefunc:null},e=function(e){var g,h=a.extend({},f.defaults,e);return h.webURL?"/"!==h.webURL.charAt(h.webURL.length-1)&&(h.webURL+="/"):h.webURL=c(),h.webURL+="_vti_bin/People.asmx",h.cacheKey=h.webURL+"?"+[h.searchText,h.maxResults,h.principalType].join("|"),h.isCached=b.isCached(h.cacheKey),h.cacheXML&&h.isCached?(g=b(h.cacheKey),a.isFunction(h.completefunc)&&g.then(function(a,b){h.completefunc(a,b)}),g):(g=a.Deferred(function(c){h.isCached&&b.clear(h.cacheKey),a.ajax({type:"POST",cache:!1,async:h.async,url:h.webURL,contentType:"text/xml;charset=utf-8",dataType:"xml",data:'<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><SearchPrincipals xmlns="http://schemas.microsoft.com/sharepoint/soap/"><searchText>'+h.searchText+"</searchText><maxResults>"+h.maxResults+"</maxResults><principalType>"+h.principalType+"</principalType></SearchPrincipals></soap:Body></soap:Envelope>",complete:function(e,f){return"error"===f||d(e)?(h.cacheXML&&b.clear(h.cacheKey),void c.rejectWith(a,[e,f])):(c.resolveWith(a,[e,f]),void(a.isFunction(h.completefunc)&&h.completefunc(e,f)))}})}).promise(),h.cacheXML&&b(h.cacheKey,g),g)},f}();return e}(P,b,a,d),B=function(a,b){var c=function(){var c=null,d=function(){return c.apply(this,arguments)};return d.defaults={principalKeys:[],principalType:"All",addToUserInfoList:!0,async:!0},c=function(c){var e=a.extend({},d.defaults,c);e.webURL?"/"!==e.webURL.charAt(e.webURL.length-1)&&(e.webURL+="/"):e.webURL=b(),e.webURL+="/_vti_bin/People.asmx",a.isArray(e.principalKeys)||(e.principalKeys=[e.principalKeys]),e.principalXml="";var f,g,h=/<string>/i;for(f=0,g=e.principalKeys.length;g>f;f++)e.principalXml+=h.test(e.principalKeys[f])?e.principalKeys[f]:"<string>"+e.principalKeys[f]+"</string>";return a.ajax({type:"POST",cache:!1,async:e.async,url:e.webURL,contentType:"text/xml;charset=utf-8",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/ResolvePrincipals")},dataType:"xml",data:'<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><ResolvePrincipals xmlns="http://schemas.microsoft.com/sharepoint/soap/"><principalKeys>'+e.principalXml+"</principalKeys><principalType>"+e.principalType+"</principalType><addToUserInfoList>"+e.addToUserInfoList+"</addToUserInfoList></ResolvePrincipals></soap:Body></soap:Envelope>"})},d}();return c}(P,a),C=void 0,D=function(a,b,c,d,e,f,g){var h,i={};return i.defaults={allowMultiples:!0,maxSearchResults:50,webURL:null,type:"User",onPickUser:null,onCreate:null,onRemoveUser:null,inputPlaceholder:"Type and Pick",appendTo:null,minLength:3,resolvePrincipals:!0,meKeyword:"[me]",meKeywordLabel:"Current User",filterSuggestions:null},h=function(f,h){var j=Array.prototype.slice.call(arguments,1),k=a(f);return"string"==typeof h?function(a){return a.is("input")&&a.hasClass("hasPickSPUser")?i.handleAction.apply(a,j):k}(k.eq(0)):k.each(function(){var f=a(this),j=a.extend({},i.defaults,h,{eleUserInput:f.css("display","none").addClass("hasPickSPUser")});j.webURL||(j.webURL=c()),j.maxSearchResults=parseInt(j.maxSearchResults)||50;var k=a(b).find(".pt-pickSPUser").clone(1).insertAfter(f);j.eleSelected=k.find("div.pt-pickSPUser-selected").empty().on("click",".tt-delete-icon",function(){i.removeUser(this)}),j.elePickInput=k.find("div.pt-pickSPUser-input"),j.isUserAlreadySelected=function(a,b){var c="div[data-pickspuserid='"+a+"']";return b&&(c+="[data-pickspusername='"+b+"']"),j.eleSelected.find(c).length>0},j.addPeopleToList=function(b,c){var d,e,f,h,k=String(b).split(";#"),l=k.length;for(d=0;l>d;d++)e=k[d],d++,f=k[d],"<userid/>"===e.toLowerCase()&&(f=j.meKeywordLabel),h=i.getUserHtmlElement(j,e,f).appendTo(j.eleSelected),function(b,c){var d=c;"<userid/>"===e.toLowerCase()&&(d=j.meKeyword),j.getSearchResults(d).done(function(d){var e=String(c).toLowerCase();a.each(d,function(a,c){var d=String(c.displayName).toLowerCase();return d===e?(b.data("pickspuser_object",c),!1):void 0})})}(h,f,e);g(j.eleSelected.find("div.pt-pickSPUser-person-cntr")),j.allowMultiples===!1&&j.elePickInput.css("display","none"),i.storeListOfUsers(j.eleSelected,c)},j.getSearchResults=function(b){return a.Deferred(function(c){d({searchText:b,maxResults:j.maxSearchResults,principalType:j.type,async:!0,webURL:j.webURL,completefunc:function(d,e){var f=a(d.responseXML),g=[];String(j.meKeyword).indexOf(b.toLowerCase())>-1&&g.push({displayName:j.meKeywordLabel,accountId:"<UserID/>",accountName:j.meKeywordLabel,accountType:"User",value:j.meKeywordLabel,label:j.meKeywordLabel}),f.find("PrincipalInfo").each(function(){var b=a(this),c={displayName:b.find("DisplayName").text(),accountId:b.find("UserInfoID").text(),accountName:b.find("AccountName").text(),accountType:b.find("PrincipalType").text(),value:b.find("DisplayName").text(),label:""};c.label+=c.displayName,g.push(c)}),j.filterSuggestions&&(g=j.filterSuggestions(g)),c.resolveWith(d,[g,d,e])}})}).promise()},j.allowMultiples===!0&&j.eleSelected.addClass("pt-pickSPUser-selected-multiple");var l={};return j.elePickInput.find("input[name='pickSPUserInputField']").attr("placeholder",j.inputPlaceholder).autocomplete({minLength:j.minLength,appendTo:j.appendTo||j.elePickInput,source:function(a,b){return a.term in l?void b(l[a.term]):(l[a.term]=[],void j.getSearchResults(a.term).then(function(c){l[a.term].push.apply(l[a.term],c),b(l[a.term])}))},select:function(b,c){if(j.allowMultiples===!1)j.eleSelected.empty();else if(j.isUserAlreadySelected(c.item.accountId,c.item.displayName))return void setTimeout(function(){b.target.value=""},50);var d=function(){var d=i.getUserHtmlElement(j,c.item.accountId,c.item.displayName).appendTo(j.eleSelected);d.data("pickspuser_object",c.item),i.storeListOfUsers(k),g(k.find("div.pt-pickSPUser-person-cntr")),setTimeout(function(){b.target.value=""},50),j.allowMultiples===!1&&j.elePickInput.hide(),a.isFunction(j.onPickUser)&&j.onPickUser.call(j.eleUserInput,a.extend({},c.item)),f.trigger(a.Event("spwidget:peoplePickerAdd"),[j.eleUserInput,a.extend({},c.item)])};"-1"===c.item.accountId&&j.resolvePrincipals?e({principalKeys:c.item.accountName}).then(function(b){c.item.accountId=a(b).find("AccountName:contains('"+c.item.accountName+"')").parent().find("UserInfoID").text(),d()}):d()}}),k.data("pickSPUserContainerOpt",j),f.data("pickSPUserContainer",k),f.val()&&j.addPeopleToList(f.val(),!0),a.isFunction(j.onCreate)&&j.onCreate.call(f,f),f.trigger(a.Event("spwidget:peoplePickerCreate"),[j.eleUserInput]),this})},i.getUserHtmlElement=function(c,d,e){var f=a(b).find(".pt-pickSPUser-person").clone(1);return f.attr("data-pickSPUserID",d),f.find("span.pt-person-name").append(e).end().attr("data-pickSPUserNAME",e),f},i.removeUser=function(b){var c=a(b).closest("div.pt-pickSPUser"),d=c.data("pickSPUserContainerOpt"),e=a(b).closest("div.pt-pickSPUser-person"),f=e.data("pickspuser_object"),g=!0;a.isFunction(d.onRemoveUser)&&d.onRemoveUser.call(d.ele,d.ele,e,f),g!==!1&&(e.fadeOut("fast",function(){a(this).remove(),i.storeListOfUsers(c)}),d.allowMultiples===!1&&d.elePickInput.show("fast",function(){d.elePickInput.find("input").focus()
}),d.eleUserInput.trigger(a.Event("spwidget:peoplePickerRemove"),[d.eleUserInput,f]))},i.storeListOfUsers=function(b,c){var d=a(b).closest("div.pt-pickSPUser"),e=d.data("pickSPUserContainerOpt"),f="",g={};d.find("div.pt-pickSPUser-selected div.pt-pickSPUser-person").each(function(){var b=a(this),c=b.attr("data-pickSPUserID")+";#"+a(this).attr("data-pickSPUserNAME");g[c]||(g[c]=!0,f&&(f+=";#"),f+=c)}),e.eleUserInput.val(f),c||e.eleUserInput.change()},i.handleAction=function(b,c,d){b=String(b).toLowerCase(),c=String(c).toLowerCase();var e=a(this).data("pickSPUserContainer").data("pickSPUserContainerOpt"),g=this;if("method"===b)switch(c){case"clear":e.eleUserInput.val(""),e.eleSelected.empty(),e.allowMultiples===!1&&(e.eleSelected.css("display","none"),e.elePickInput.show());break;case"destroy":a(this).hasClass("hasPickSPUser")&&a(this).removeClass("hasPickSPUser").next(".pt-pickSPUser").remove().show().trigger("change");break;case"add":e.addPeopleToList(d);break;case"remove":if(d){var h=e.eleSelected.find("div[data-pickspuserid='"+d+"']");h.length||(h=e.eleSelected.find("div[data-pickspusername='"+d+"']")),h.length&&i.removeUser(h)}break;case"getselected":g=f(e.eleUserInput.val())}return g},h.defaults=i.defaults,h}(P,z,a,A,B,v,k),E='<div id="filter_main_ui">\r\n    <div class="spwidget-filter" style="display: none;">\r\n        <div class="spwidget-filter-column-cntr ui-widget-content"></div>\r\n        <div class="spwidget-filter-button-cntr">\r\n            <button type="button" class="spwidget-button ui-priority-secondary" name=\'reset\'>Reset</button>\r\n            <button type="button" class="spwidget-button" name=\'filter\'>Filter</button>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div id="filter_column">\r\n    <div class="spwidget-column spwidget-type-{{type}}"\r\n            data-spwidget_column_type="{{type}}"\r\n            data-spwidget_list="{{list}}"\r\n            data-spwidget_sp_type="{{sp_type}}"\r\n            data-spwidget_sp_format="{{sp_format}}" >\r\n        <div class="spwidget-filter-value-cntr">\r\n            <label>{{DisplayName}}</label>\r\n            <div class="spwidget-filter-value-input">\r\n                __COLUMN__UI__\r\n            </div>\r\n        </div>\r\n        <div class="spwidget-filter-type-cntr" title="Match Options">\r\n            <select name="{{Name}}_type" class="spwidget-filter-type" tabindex="-1">\r\n                <option value="Contains">Contains</option>\r\n                <option value="Eq" selected="selected">Equal</option>\r\n                <option value="Neq">Not Equal</option>\r\n                <option value="IsNull">Is Blank</option>\r\n                <option value="IsNotNull">Is Not Blank</option>\r\n                __OTHER_FILTER_TYPES__\r\n            </select>\r\n            <select name="{{Name}}_match" class="spwidget-match-type" tabindex="-1">\r\n                <option value="Or" selected="selected">Any</option>\r\n                <option value="And">All</option>\r\n            </select>\r\n            <select name="{{Name}}_order" class="spwidget-sort-order" tabindex="-1">\r\n                <option value="" selected="selected">Sort</option>\r\n                <option value="Asc">&#9650; Ascending</option>\r\n                <option value="Des">&#9660; Descending</option>\r\n            </select>\r\n        </div>\r\n        <div class="spwidget-column-actions">\r\n            <a style="display:none;" href="javascript:" tabindex="-1" data-action="remove" class="spwidget-column-action">\r\n                <span class="ui-icon ui-icon-circle-close">remove</span>\r\n            </a>\r\n            <div class="spwidget-column-sort-actions">\r\n                <a href="javascript:" tabindex="-1" data-action="up" class="spwidget-column-action" title="Move up">\r\n                    <span class="ui-icon ui-icon-circle-arrow-n">Move Up</span>\r\n                </a>\r\n                <a href="javascript:" tabindex="-1" data-action="down" class="spwidget-column-action" title="Move down">\r\n                    <span class="ui-icon ui-icon-circle-arrow-s">Move Down</span>\r\n                </a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div id="filter_text_field">\r\n    <input name="{{Name}}" title="{{DisplayName}}" type="text" value="" class="spwidget-input spwidget-filter-input" />\r\n    <span class="spwidget-tooltip">{{tooltip}}</span>\r\n</div>\r\n<div id="filter_choice_field">\r\n    <label>\r\n        <input name="{{Name}}" title="{{DisplayName}}" type="checkbox" value="{{value}}" class="spwidget-input spwidget-filter-input" />\r\n        {{value}}\r\n    </label>\r\n</div>',F=void 0,G=function(a,b,c,d,e,f,g,h,i,j,k){var l,m={};return m.isInitDone=!1,m.templates=null,m.defaults={list:"",webURL:c(),columns:["Title"],textFieldTooltip:"Use a semicolon to delimiter multiple keywords.",peopleFieldTooltip:"Use [me] keyword to represent current user.",definedClass:"spwidget-column-dirty",showFilterButton:!0,showFilterButtonTop:!0,filterButtonLabel:"Filter",onFilterClick:null,onReady:null,onReset:null,ignoreKeywords:/^(of|and|a|an|to|by|the|or|from)$/i,delimeter:";",height:null},l=function(c,e){var g=Array.prototype.slice.call(arguments,1),h=a(c);if(m.isInitDone||(m.isInitDone=!0,m.templates=a(b)),"string"==typeof e){if(!h.eq(0).hasClass("hasSPFilterPanel"))return;return function(a){var b=a.eq(0).find("div.spwidget-filter").data("SPFilterPanelInst"),c=e.toLowerCase(),d=b.$ele;switch(c){case"getfilter":d=m.getFilterValues(b);break;case"setfilter":m.setFilterValues(b,g[1]);break;case"reset":m.doResetFilter(b);break;case"destroy":b.$ele.removeClass("hasSPFilterPanel").empty()}return d}(h)}return h.each(function(){var b=a.extend({},m.defaults,e),c={$ele:a(this),$ui:null,$uiFilterSortCntr:null,$uiFilterColumnCntr:null,$uiSortButtons:null,opt:b};return c.getListDefinition=function(){return a.Deferred(function(c){d({listName:b.list,cacheXML:!0,async:!0,webURL:b.webURL,completefunc:function(b,d){var e=a(b.responseXML);return"error"===d?void c.rejectWith(e,[b,d]):e.SPMsgHasError()?void c.rejectWith(e,[b,d]):void c.resolveWith(e,[b,d])}})}).promise()},c.showSortOrder=function(){c.$uiFilterColumnCntr.hide(),c.$uiFilterSortCntr.show()},c.showFilterColumns=function(){c.$uiFilterSortCntr.hide(),c.$uiFilterColumnCntr.show()},c.buildWidget=function(){return a.Deferred(function(b){c.getListDefinition().then(function(){var d=this,g="",h=m.templates.filter("#filter_column").html();c.$ui=a(m.templates.filter("#filter_main_ui").html()).appendTo(c.$ele.empty().addClass("hasSPFilterPanel")),c.$uiFilterColumnCntr=c.$ui.find("div.spwidget-filter-column-cntr"),c.$uiFilterSortCntr=c.$ui.find("div.spwidget-filter-sort-cntr"),c.$list=d,c.opt.height&&c.$uiFilterColumnCntr.css("height",c.opt.height),a.each(c.opt.columns,function(b,e){var i=d.find("Field[DisplayName='"+e+"']"),j=h,k="",l=null;if(i.length||(i=d.find("Field[Name='"+e+"']")),i.length){switch(l={type:null,otherFilterTypes:"",sp_type:i.attr("Type"),sp_format:i.attr("Format"),Name:i.attr("Name"),DisplayName:i.attr("DisplayName")},i.attr("Type")){case"Choice":case"MultiChoice":i.find("CHOICES CHOICE").each(function(b,c){k+=f(m.templates.filter("#filter_choice_field").html(),{DisplayName:i.attr("DisplayName"),Name:i.attr("Name"),value:a(c).text()})}),j=j.replace(/__COLUMN__UI__/,k).replace(/__OTHER_FILTER_TYPES__/,""),j=f(j,{DisplayName:i.attr("DisplayName"),type:"choice",Name:i.attr("Name")});break;case"Attachments":l.type="boolean",l.input_ui='<select name="'+l.Name+'" class="spwidget-input spwidget-filter-input"><option value=""></option><option value="1">Yes</option><option value="0">No</option></select>',j=f(j.replace(/__COLUMN__UI__/,l.input_ui).replace(/__OTHER_FILTER_TYPES__/,""),l);break;default:switch(i.attr("Type")){case"Lookup":case"LookupMulti":null===l.type&&(l.type="lookup",l.list=i.attr("List"),"Self"===l.list&&(l.list=d.find("List").attr("Title")));break;case"User":case"UserMulti":null===l.type&&(l.type="people");break;case"Counter":case"Number":case"RatingCount":case"Likes":null===l.type&&(l.type="text",l.otherFilterTypes='<option value="Gt">Greater Than</option><option value="Lt">Less Than</option>');break;case"DateTime":null===l.type&&(l.type="date",l.otherFilterTypes='<option value="Gt">After</option><option value="Lt">Before</option>',l.sp_format="DateOnly"!==i.attr("Format")?"DateTime":"DateOnly");break;default:l.type="text"}k=m.templates.filter("#filter_text_field").html(),j=j.replace(/__COLUMN__UI__/,k).replace(/__OTHER_FILTER_TYPES__/,l.otherFilterTypes),j=f(j,a.extend(l,{DisplayName:i.attr("DisplayName"),Name:i.attr("Name"),tooltip:c.opt.textFieldTooltip}))}g+=j}}),c.$uiFilterColumnCntr.html(g),c.$ele.find("div.spwidget-type-lookup input").each(function(){var b=a(this);i(b,{list:b.closest("div.spwidget-column").data("spwidget_list"),template:'<div>{{Title}} <span class="spwidgets-item-remove">[x]</span></div>',listTemplate:"{{Title}}",allowMultiples:!0,readOnly:!1,filter:"",showSelector:!0}),b.parent().find(".spwidget-tooltip").remove()}),c.$ele.find("div.spwidget-type-people input").each(function(){var b=a(this),e=d.find("Field[Name='"+b.attr("name")+"']"),f="User";"PeopleOnly"!==e.attr("UserSelectionMode")&&(f="All"),j(b,{allowMultiple:!0,type:f}),b.parent().find(".spwidget-tooltip").html(c.opt.peopleFieldTooltip)}),c.$ele.find("div.spwidget-type-date").each(function(){var b=a(this),c=b.find("input");return k(c,{allowMultiples:!0,showTimepicker:"DateTime"===b.data("spwidget_sp_format")?!0:!1}),b.find(".spwidget-tooltip").remove(),b.find("select.spwidget-filter-type").val("Eq").find("option[value='Contains']").remove(),this}),c.$ele.find(".spwidget-type-boolean div.spwidget-filter-type-cntr").css("display","none"),c.opt.showFilterButton||c.opt.showFilterButtonTop?c.$ui.find("div.spwidget-filter-button-cntr").each(function(){var b=a(this),d=a();c.opt.showFilterButtonTop&&(d=d.add(b.clone(!0)).prependTo(c.$ui)),c.opt.showFilterButton?d=d.add(b):b.remove(),d.find("button[name='filter']").button({icons:{primary:"ui-icon-search"},label:c.opt.filterButtonLabel}).on("click",m.onFilterButtonClick),d.find("button[name='reset']").button({icons:{primary:"ui-icon-arrowreturnthick-1-n"},text:!1}).on("click",function(){return m.doResetFilter(c),this})}):c.$ui.find("div.spwidget-filter-button-cntr").remove(),c.$ui.on("change.SPWidgets.SPFilterPanel","select.spwidget-filter-type,select.spwidget-sort-order",m.onFilterTypeChange).on("click.SPWidgets.SPFilterpanel","a.spwidget-column-action",m.onFilterTypeChange),""!==c.opt.definedClass&&c.$ui.on("change.SPWidgets.SPFilterPanel",".spwidget-filter-input",m.onFilterInputChange),c.$ui.data("SPFilterPanelInst",c),a.isFunction(c.opt.onReady)&&c.opt.onReady.call(c.$ele,e),c.$ui.fadeIn().promise().then(function(){a(this).css("display",""),b.resolve()})}).fail(function(){var a=this;c.$ele.html('<div class="ui-state-error">Unable to retrieve list information. '+a.SPGetMsgError()+"</div>"),b.reject()})}).promise()},c.opt.ignoreKeywords&&!c.opt.ignoreKeywords instanceof RegExp&&(c.opt.ignoreKeywords=/Inst.opt.ignoreKeywords/i),c.buildWidget(),this})},m.onFilterInputChange=function(){var b=a(this),c=b.closest("div.spwidget-filter-value-input"),d=c.closest("div.spwidget-column"),e=b.val(),f=c.closest("div.spwidget-filter").data("SPFilterPanelInst");return d.is(".spwidget-type-choice")&&(c.find(".spwidget-filter-input:checked").length||(e="")),m.isColumnDirty(d)?d.addClass(f.opt.definedClass):d.removeClass(f.opt.definedClass),this},m.onFilterTypeChange=function(){var b=a(this),c=b.closest("div.spwidget-column"),d=c.find("div.spwidget-filter-type-cntr select.spwidget-match-type"),e=c.find("div.spwidget-filter-value-cntr"),f=e.find(".spwidget-input"),g="",h=b.val(),i=b.closest("div.spwidget-filter").data("SPFilterPanelInst");return b.is("select.spwidget-sort-order")?void(b.val()?(c.addClass("spwidget-has-sort-order"),c.addClass(i.opt.definedClass)):(c.removeClass("spwidget-has-sort-order"),m.isColumnDirty(c)||c.removeClass(i.opt.definedClass))):b.is("a.spwidget-column-action")?(g=b.data("action"),void(("up"===g||"down"===g)&&m.moveColumn(c,"up"===g?!0:!1))):("IsNull"===h||"IsNotNull"===h?(e.addClass("spwidget-disabled"),f.attr("disabled","disabled"),d.attr("disabled","disabled"),c.addClass(i.opt.definedClass)):(e.removeClass("spwidget-disabled"),f.removeAttr("disabled","disabled"),d.removeAttr("disabled"),m.isColumnDirty(c)||c.removeClass(i.opt.definedClass)),this)},m.onFilterButtonClick=function(){var b=a(this).closest("div.spwidget-filter").data("SPFilterPanelInst"),c=null;return a.isFunction(b.opt.onFilterClick)&&(c=m.getFilterValues(b),b.opt.onFilterClick.call(b.$ele,c)),this},m.doResetFilter=function(b){return a.isFunction(b.onReset)&&b.onReset.call(b.$ele,m.getFilterValues(b))===!0?b:(b.$ui.find("div[data-spwidget_column_type='text'] input").val("").end().find("div[data-spwidget_column_type='choice'] input").prop("checked",!1).end().find("div[data-spwidget_column_type='boolean'] .spwidget-filter-value-input select").val(""),k(b.$ui.find(".hasSPDateField"),"reset"),j(b.$ui.find(".hasPickSPUser"),"method","clear"),i(b.$ui.find(".hasLookupSPField"),"method","clear"),""!==b.opt.definedClass&&b.$ui.find("."+b.opt.definedClass).removeClass(b.opt.definedClass),b.$ui.find("select.spwidget-filter-type").each(function(){var b=a(this),c=b.val();("IsNull"===c||"IsNotNull"===c)&&(b.val("Eq"),b.change())}),b.$ui.find("select.spwidget-sort-order").val("").change(),b)},m.getFilterValues=function(b){function c(a){return g({type:a.logicalType,values:a.values,onEachValue:function(b){return"<"+a.matchType+"><FieldRef Name='"+a.columnName+"' /><Value Type='Text'>"+h.escape(b)+"</Value></"+a.matchType+">"}})}var d={CAMLQuery:"",CAMLOrderBy:"",URLParams:"",filters:{},count:0},f=b.$ui.find("div.spwidget-column"),i=[],j="";return f.each(function(f,h){var k=a(h),l=k.find(".spwidget-input"),n=l.attr("name"),o=new m.ColumnFilter({columnName:n,matchType:k.find("select.spwidget-filter-type").val(),logicalType:k.find("select.spwidget-match-type").val(),sortOrder:k.find("select.spwidget-sort-order").val()}),p=k.data("spwidget_column_type"),q={};if(o.sortOrder&&(o.CAMLOrderBy+='<FieldRef Name="'+n+'" Ascending="'+("Asc"===o.sortOrder?'TRUE"':'FALSE"')+"/>"),"IsNull"===o.matchType||"IsNotNull"===o.matchType)o.CAMLQuery="<"+o.matchType+"><FieldRef Name='"+n+"' /></"+o.matchType+">",o.count+=1;else switch(p){case"choice":case"multichoice":l.each(function(){var b=a(this),c=b.val();b.is(":checked")&&o.values.push(c)}),o.values.length&&(o.count=o.values.length,o.CAMLQuery=c(o));break;case"lookup":case"people":!function(){var b=[];l.each(function(){var c,d,f=a(this),g=e(f.val());for(c=0,d=g.length;d>c;c++)g[c].id&&(o.values.push(g[c].id+";#"+g[c].title),b.push(g[c].id))}),o.values.length&&(o.count=o.values.length,o.CAMLQuery=g({type:o.logicalType,values:b,onEachValue:function(a){return"<"+o.matchType+"><FieldRef Name='"+o.columnName+"' LookupId='True'/><Value Type='Lookup'>"+a+"</Value></"+o.matchType+">"}}))}();break;case"date":l.each(function(){var a=l.SPDateField("getDate");return a.dates.length&&(o.values=a.dates,o.count=o.values.length,o.CAMLQuery=g({type:o.logicalType,values:o.values,onEachValue:function(a){return"<"+o.matchType+"><FieldRef Name='"+o.columnName+"'/><Value Type='DateTime'>"+a+"</Value></"+o.matchType+">"}})),!1});break;case"text":case"boolean":String(a.trim(l.val())).length&&!function(){var d,e,f,g=l.val().split(b.opt.delimeter);for(d=0,e=g.length;e>d;d++)f=a.trim(g[d]),!b.opt.ignoreKeywords.test(f)&&f&&o.values.push(f);o.CAMLQuery=c(o),o.count=o.values.length}()}(o.count>0||o.CAMLOrderBy)&&(q[n]={},o.CAMLOrderBy&&(j+=o.CAMLOrderBy,q[n].sortOrder=o.sortOrder),o.count>0&&(i.push(o.CAMLQuery),d.count+=o.count,d.filters[n]=o,q[n].matchType=o.matchType,q[n].logicalType=o.logicalType,q[n].values=o.values),o.URLParams=a.param(q,!1),""!==d.URLParams&&(d.URLParams+="&"),d.URLParams+=o.URLParams)}),d.count>1?d.CAMLQuery=g({type:"AND",values:i}):1===d.count&&(d.CAMLQuery=i[0]),j&&(d.CAMLOrderBy+="<OrderBy>"+j+"</OrderBy>"),d},m.setFilterValues=function(b,c){return"object"!=typeof c||a.isEmptyObject(c)?b:(m.doResetFilter(b),a.each(c,function(c,d){var e=b.$ui.find(".spwidget-filter-input[name='"+c+"']"),f=e.closest("div.spwidget-column"),g=f.data("spwidget_column_type"),h=f.find("select[name='"+c+"_type']"),k=f.find("div.spwidget-filter-type-cntr select.spwidget-match-type"),l=f.find("select.spwidget-sort-order"),n=new m.ColumnFilter;if(a.extend(n,d),"boolean"!==g&&(n.matchType&&"boolean"!==g&&h.val(n.matchType),n.logicalType&&k.val(n.logicalType)),"boolean"===g||"IsNull"!==d.matchType&&"IsNotNull"!==d.matchType)switch(g){case"text":case"boolean":e.val(n.values instanceof Array?n.values.join(b.opt.delimeter):n.values);break;case"choice":case"multichoice":a.each(n.values,function(a,b){e.filter("[value='"+b+"']").prop("checked",!0)});break;case"lookup":i(e,"method","add",n.values.join(";#"));break;case"people":j(e,"method","add",n.values.join(";#"));break;case"date":"DateTime"===f.data("spwidget_sp_format")?e.SPDateField("setDate",n.values):e.SPDateField("setDate",n.values,"yy-mm-dd")}else h.change();n.sortOrder&&l.val("asc"===String(n.sortOrder).toLowerCase()?"Asc":"Des"),l.change(),e.change()}),b)},m.ColumnFilter=function(a){var b=function(){},c=new b;return"object"!=typeof a&&(a={}),c.columnName=a.columnName||"",c.matchType=a.matchType||"",c.logicalType=a.logicalType||"",c.sortOrder=a.sortOrder||"",c.values=a.values||[],c.CAMLQuery=a.CAMLQuery||"",c.CAMLOrderBy=a.CAMLOrderBy||"",c.URLParams=a.URLParams||"",c.count=a.count||0,c},m.moveColumn=function(a,b){var c=a.parent().children(),d=c.length,e=c.index(a);b&&0===e||(b||e+1!==d)&&(b?a.insertBefore(a.prev()):a.insertAfter(a.next()))},m.isColumnDirty=function(b){var c=!1,d=b.data("spwidget_column_type"),e=b.find(".spwidget-input");return"choice"===d||"multichoice"===d?e.filter(":checkbox").each(function(){var b=a(this);return b.is(":checked")?(c=!0,!1):void 0}):e.val()&&(c=!0),c||(e=b.find("select.spwidget-sort-order"),e.val()&&(c=!0)),c},l.defaults=m.defaults,l}(P,E,a,c,v,i,u,w,y,D,s),H='<div class="SPControlUploadUI spcontrolupload">\n    <div class="mainContainer">\n        <div class="buttonPane ui-state-default">\n            <div class="upload_button">\n                Upload\n            </div>\n        </div>\n        <div class="iFrameWindow ui-state-default">\n            <iframe name="SPControlUploadUI" frameborder="0" scrollbars="yes" scrolling="yes"></iframe>\n        </div>\n        <div class="loadingOverlay ui-widget-content">\n            <div class="loadingOverlayMsg"></div>\n        </div>\n        <div class="spwidget-success-cntr ui-widget-content">\n            <div class="spwidget-msg-cntr">\n                <span class="spwidget-msg">Upload Successful!</span> \n                <span class="spwidget-close">x</span> \n            </div>\n        </div>\n        <div class="spwidget-error-cntr ui-state-error">\n            <div class="spwidget-msg-cntr">\n                <span class="spwidget-msg">Error</span> \n                <span class="spwidget-close">x</span> \n            </div>\n        </div>\n    </div>\n</div>\n\n<div id="SPControlUploadModUI" \n    style="\n        position:   absolute;\n        width:      99.9%;\n        height:     99.9%;\n        left:       0px;\n        top:        0px;\n        padding-left:       .5em;\n        background-color:   white;">\n    <div class="SPControlUploadModUIFileSelected"\n        style="\n        background-position: left center;\n        background-repeat: no-repeat;\n        background-image: url(\'/_layouts/images/urn-content-classes-smartfolder16.gif\');\n        padding: 0.5em 2em;">Select...</div>\n</div>\n',I=function(){var a=function(a){var b={12:"2007",14:"2010",15:"2013"},c=12,d=!1;return"undefined"!=typeof SP&&(c=14,SP.ClientSchemaVersions&&SP.ClientSchemaVersions.currentVersion&&(c=parseInt(SP.ClientSchemaVersions.currentVersion),d=!0),d||"undefined"==typeof _spPageContextInfo||(c=parseInt(_spPageContextInfo.webUIVersion),4===c&&(c=14))),a&&(c=b[c]||c),c};return a}(),J=void 0,K=function(a,b,c,d,e,f){var g,h={};return h.isInitDone=!1,h.defaults={listName:"",folderPath:"",uploadDonePage:"",onPageChange:null,onUploadDone:null,uploadUrlOpt:"",overwrite:!1,uploadPage:"",overlayClass:"",overlayBgColor:"white",overlayMessage:"<div>Working on it</div>",selectFileMessage:"Click here to select file...",uploadDoneMessage:"Upload Successful!",fileNameErrorMessage:'A file name cannot contain any of the following characters: \\ / : * ? " &lt; &gt; | # { } % ~ &amp;',noFileErrorMessage:"No file selected!",checkInFormHeight:"25em",webURL:null,debug:!1,filenameInputSelector:"input[id$='onetidIOFile']"},g=function(c,g){return h.isInitDone||(h.isInitDone=!0,h.defaults.webURL||(h.defaults.webURL=e())),a(c).each(function(){var c,e=a.extend({},h.defaults,g);if(e.log=e.debug?h.log:function(){},e.showHideBusy=function(b){return a.Deferred(function(a){b?e.$busyOverlay.fadeOut("fast").promise().then(function(){a.resolve()}):e.$busyOverlay.fadeIn("slow").promise().then(function(){a.resolve()})}).promise()},e.showHideFullForm=function(a){return a?(e.$content.removeClass("spwidget-show-full-form"),e.$iframeCntr.css({overflow:"",height:""})):(e.$content.addClass("spwidget-show-full-form"),e.$iframeCntr.css({overflow:"auto",height:"auto"})),e},e.showHideSuccess=function(a){return a?e.$successCntr.stop().fadeOut().promise(function(){e.$successCntr.css("display","none")}):e.$successCntr.stop().show().promise(function(){e.$successCntr.css("display","block")}),e},e.showError=function(b){var c=a.extend({},{message:"",autoHide:!0},b);return e.$errorCntrMsg.html(c.message),e.$errorCntr.stop().css("display","block"),c.autoHide&&e.$errorCntr.animate({opacity:1},5e3,function(){e.clearError()}),e},e.clearError=function(){return e.$errorCntr.css("display","none"),e},e.resetWidget=function(){return e.ev={state:1,action:"uploading",hideOverlay:!0,pageUrl:"",page:null,isUploadDone:!1,file:{}},e.$iframe.attr("src",e.uploadPage),e},e.getUploadedFileRow=function(){var a={};return d({async:!1,webURL:e.webURL,listName:e.listName,CAMLQuery:"<Query><Where><Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'><UserID/></Value></Eq></Where><OrderBy><FieldRef Name='Modified' Ascending='FALSE'/></OrderBy></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='ID'/><FieldRef Name='EncodedAbsUrl'/><FieldRef Name='FileLeafRef' /><FieldRef Name='Author' /><FieldRef Name='Editor' /><FieldRef Name='Created' /><FieldRef Name='Modified' /></ViewFields>",CAMLRowLimit:1,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(b,c,d){d.length&&(a=d[0])}}),a},e.isUploadPage=function(a){var b=!1,c=document.createElement("a"),d=null;return c.href=String(a).toLowerCase(),e.userUploadPage?(d=document.createElement("a"),d.href=String(e.userUploadPage).toLowerCase(),c.pathname===d.pathname&&(b=!0)):b=/upload(ex)?\.aspx$/.test(c.pathname),b},e.listName&&0!==e.listName.indexOf("{")&&(e.listName=h.getListUID(e.listName)),!e.listName)return a(this).html('<div class="ui-state-error">Input parameter [listName] not valid!</div>'),this;if(e.spVersion=f(!0),e.userUploadPage=e.uploadPage,e.uploadPage=String(e.uploadPage),e.uploadPage){if(-1===e.uploadPage.toLowerCase().indexOf("http")){var i="/";0===e.uploadPage.indexOf("/")&&(i=""),e.uploadPage=e.webURL+i+e.uploadPage}}else switch(e.spVersion){case"2013":e.uploadPage=e.webURL+"/_layouts/15/UploadEx.aspx";break;case"2010":e.uploadPage=e.webURL+"/_layouts/UploadEx.aspx";break;default:e.uploadPage=e.webURL+"/_layouts/Upload.aspx"}return e.uploadDonePage=String(e.uploadDonePage),e.uploadDonePage||(e.uploadDonePage=e.webURL+"/_layouts/images/STS_ListItem_43216.gif"),e._iframeLoadId=1,e._uploadUrlParams="?List="+encodeURIComponent(e.listName)+"&RootFolder="+encodeURIComponent(e.folderPath)+"&Source="+encodeURIComponent(e.uploadDonePage)+"&"+(new Date).getTime()+"=1&"+e.uploadUrlOpt,e.uploadPage=e.uploadPage+e._uploadUrlParams,e._lastError="",e._reloadCount=0,e.ev={state:1,action:"uploading",hideOverlay:!0,pageUrl:"",page:null,isUploadDone:!1,file:{}},e.$ele=a(this),c={},e.overlayBgColor&&(c["background-color"]=e.overlayBgColor),e.$cntr=a(a(b).filter("div.SPControlUploadUI").clone()).appendTo(e.$ele.addClass("hasSPControlUploadUI").empty()).data("SPControlUploadOptions",e),e.$buttonCntr=e.$cntr.find("div.buttonPane").click(function(){h.onUpload(this)}),e.$content=e.$cntr.find("div.mainContainer"),e.$iframeCntr=e.$cntr.find("div.iFrameWindow"),e.$iframe=e.$iframeCntr.children("iframe"),e.$busyOverlay=e.$cntr.find("div.loadingOverlay"),e.$busyOverlayMsg=e.$busyOverlay.find("div.loadingOverlayMsg"),e.$successCntr=e.$cntr.find("div.spwidget-success-cntr"),e.$errorCntr=e.$cntr.find("div.spwidget-error-cntr"),e.$errorCntrMsg=e.$errorCntr.find(".spwidget-msg"),e.reInvalidChr=new RegExp('[\\/:*?"<>|#{}%~&]'),e.$successCntr.on("click",".spwidget-close",function(){e.showHideSuccess(!0)}).find(".spwidget-msg").html(e.uploadDoneMessage),e.$errorCntr.on("click",".spwidget-close",function(){e.clearError()}),e.$busyOverlay.addClass(e.overlayClass).css(c),e.$busyOverlayMsg.html(e.overlayMessage),e.showHideBusy(),e.$cntr.find("iframe").css("height",e.checkInFormHeight).load(function(){h.onIframeChange(e.$ele.find(".SPControlUploadUI"))}).attr("src",e.uploadPage).end(),this})},h.onUpload=function(b){var c=a(b).closest(".SPControlUploadUI"),d=c.find("iframe").contents(),e=d.find("input[type='file']").closest("tr").siblings().find("span"),f=c.data("SPControlUploadOptions"),g=f.ev;return f.log("Upload.onUpload("+f._iframeLoadId+"): Start...."),e.css("display","none"),d.find("input[type='file']").val()?f.reInvalidChr.test(d.find("div.SPControlUploadModUIFileSelected").text())?void f.showError({message:f.fileNameErrorMessage}):(g.state=2,g.action="preLoad",f.onPageChange&&f.onPageChange.call(f.$ele,g)===!1?!1:(f.showHideFullForm(!0),void f.showHideBusy().then(function(){return f.log("Upload.onUpload("+f._iframeLoadId+"): Clicking the OK button on upload form."),d.find("input[type='button'][id$='btnOK']").click(),e.is(":visible")?(f.log("Upload.onUpload("+f._iframeLoadId+"): Error message reported! \n"+e.text()),c.find(".loadingOverlay").css("display","none").end(),!1):void 0}))):void f.showError({message:f.noFileErrorMessage})},h.isSPBusyAnimation=function(a){return a.find("#GearPage").length?!0:a.find("#ms-loading-box").length?!0:!1},h.onIframeChange=function(c){var d=a(c).closest(".SPControlUploadUI"),e=d.data("SPControlUploadOptions"),f=0,g=a(d.find("iframe").contents());if(e.debug)try{e.log("Upload.onIframeChange(): ENTERING... Document readyState: "+g[0].readyState+" IFRAME URL: "+g[0].location.href)}catch(i){}return h.isSPBusyAnimation(g)?void e.log("Upload.onIframeChange(): EXITING... Gear page displyed."):2===e.ev.state&&"preLoad"===e.ev.action&&g[0].spcontrolupload_init_done===!0?(e.log("Upload.onIframeChange("+e._iframeLoadId+"): Exiting! ev.action=["+e.ev.action+"] and ev.state=["+e.ev.state+"] - Nothing to do. Action handled by onUpload(). Setting action to postLoad"),void(e.ev.action="postLoad")):(e._iframeLoadId++,f=e._iframeLoadId,e.log("Upload.onIframeChange("+f+"): State=["+e.ev.state+"] Action=["+e.ev.action+"]"),void setTimeout(function(){if(f!==e._iframeLoadId)return void e.log("Upload.onIframeChange("+f+"): not latest invokation! Existing.");var c=e.ev,i=g.find("form").eq(0);if(g=a(d.find("iframe").contents()),e.log("Upload.onIframeChange("+f+"): STARTING... Executing setTimeout(). URL:"+g[0].location.href),g.spcontrolupload_init_done===!0)return void e.log("Upload.onIframeChange("+f+"): EXITING!!! Page was already processed!");if(g.spcontrolupload_init_done=!0,c.pageUrl=g[0].location.href,c.page=g,e.$iframeCntr.scrollTop(0),g.scrollTop(0),e.isUploadPage(c.pageUrl)){if(e.log("Upload.onIframeChange("+f+"): URL is the upload page!"),g.find("body").css({overflow:"hidden"}),i.children(":visible").hide().end().append(a(b).filter("div#SPControlUploadModUI").clone()).find("div.SPControlUploadModUIFileSelected").html(e.selectFileMessage),new RegExp(/error/i).test(a.trim(g.find(".ms-pagetitle").text()))||new RegExp(/error/i).test(a.trim(g.find("title").text()))||new RegExp(/error\.aspx/i).test(a.trim(g.find("form").attr("action"))))return e.log("Upload.onIframeChange("+f+"): page displaying an error... Storing it and reloading upload form."),e._lastError=g.find("[id$='LabelMessage']").text(),e._reloadCount>1?(alert("Error encountered during upload which is causing program to loop. Last upload error was: "+e._lastError),void d.find(".loadingOverlay").fadeOut()):(e._reloadCount+=1,void d.find("iframe").attr("src",e.uploadPage));if(h.isSPBusyAnimation(g)&&!g.find("input[type='file']").length)return void e.log("Upload.onIframeChange("+f+"): SP processing page (GearPage)... Exiting and waiting for next page...");g.find("input[type='file']").closest("table").appendTo(g.find("#SPControlUploadModUI")).removeClass("ms-authoringcontrols");var j=g.find("#SPControlUploadModUI").find("input[type='file']").closest("tr").siblings().css("display","none").end().end().siblings("tr .ms-error").css("display","").end().on("change focus click",function(){var b=a(this),c=b.val(),d="",f="/_layouts/images/urn-content-classes-smartfolder16.gif";if(c){try{d=c.substr(c.lastIndexOf(".")+1)}catch(h){d="GEN"}f="/_layouts/images/IC"+d.toUpperCase()+".GIF",c=c.replace(/\\/g,"/").split("/").pop()||c}else c=e.selectFileMessage;g.find("#SPControlUploadModUI > div").html(c).css("background-image","url('"+f+"')")}).css({cursor:"pointer",height:"100px",position:"absolute",left:"0px",top:"0px",filter:"alpha(opacity=1)",opacity:"0.01",outline:"none","-moz-opacity":"0.01","font-size":"100px","z-index":"5"});i.on("mousemove",function(a){j.css({left:a.pageX-(j.width()-50),top:a.pageY-30}).blur()}),e._lastError&&(e.showError({message:e._lastError}),e._lastError=""),e._reloadCount=0,e.overwrite?g.find("input[type='checkbox'][name$='OverwriteSingle']").prop("checked","checked"):g.find("input[type='checkbox'][name$='OverwriteSingle']").prop("checked",""),c.state=1,c.action="postLoad",c.hideOverlay=!0}else{if(e.log("Upload.onIframeChange("+e._iframeLoadId+"): File uploaded to server! Need ["+e.uploadDonePage+"] to be done."),c.state=3,c.action="postLoad",c.hideOverlay=!0,c.file=e.getUploadedFileRow(),h.isSameUrlPage(c.pageUrl,e.uploadDonePage))e.log("Upload.onIframeChange("+e._iframeLoadId+"): Upload widget process DONE!"),c.isUploadDone=!0,c.hideOverlay=!1,e.showHideBusy(),e.showHideSuccess();else if(e.log("Upload.onIframeChange("+e._iframeLoadId+"): Post Upload Form being displayed! Hooking into form.onsubmit!"),i.length){var k=i.prop("onsubmit"),l=i.find(e.filenameInputSelector).eq(0);l.length&&(i.children(":visible").css("display","none").addClass("ptWasVisible"),l.closest("div[id^='WebPart']").appendTo(i).css("display","").removeClass("ptWasVisible")),i[0].onsubmit=function(){e.log("Upload.onIframeChange("+f+"): iframe form.onsubmit triggered!"),e.showHideBusy();var b=!0;return a.isFunction(e.onPageChange)&&(b=e.onPageChange.call(e.$ele,a.extend({},c,{state:3,action:"preLoad"}))),b===!1?(e.showHideBusy(!0),b):(a.isFunction(k)&&(b=k()),b===!1?(e.showHideBusy(!0),b):(e.showHideFullForm(!0),b))}}a(d.find("iframe")[0].contentWindow).unload(function(){return e.log("Upload.onIframeChange("+e._iframeLoadId+"): iframe.unload() triggered!"),e.showHideBusy(),e.showHideFullForm(!0),a.isFunction(e.onPageChange)?e.onPageChange.call(e.$ele,a.extend({},c,{state:3,action:"preLoad"})):void 0})}e.log("Upload.onIframeChange("+e._iframeLoadId+"): iframe page setup done!"),e.onPageChange&&e.onPageChange.call(e.$ele,c),("postload"!==c.action.toLowerCase()||c.hideOverlay===!0)&&(e.showHideBusy(!0),c.isUploadDone===!1&&3===c.state&&e.showHideFullForm()),c.isUploadDone&&(e.resetWidget(),e.$successCntr.animate({opacity:1},3e3,function(){e.showHideSuccess(!0)}),a.isFunction(e.onUploadDone)&&e.onUploadDone.call(e.$ele,c.file))
},500))},h.isSameUrlPage=function(a,b){if(!a||!b)return!1;var c=function(a){var b=document.createElement("a");return b.href=a,unescape(b.pathname)},d=String(c(a)).toLowerCase(),e=String(c(b)).toLowerCase();return d===e},h.getListUID=function(b){if(!b)return"";var d="";return c({listName:b,async:!1,cacheXML:!0,completefunc:function(b){d=a(b.responseXML).find("List").attr("ID")}}),d},h.log=function(){var b,c,d=1,e=0,f=!1,g=!1,h=["#FFFFFF","#F5F5F2"];return"undefined"==typeof console||"undefined"==typeof console.debug?b=function(){var a,b,f="";for(a=0,b=arguments.length;b>a;a++)f+='<div style="padding: .1em .1em;background-color:'+h[e]+'"><span>['+d+"] </span>"+arguments[a]+"</div>",d++,e=1===e?0:1;f&&(c.append(f),c.dialog("isOpen")||c.dialog("open"))}:f=!0,function(){if(g||(g=!0,f||(c=a("<div><h2>SPWidgets Debug Output</h2></div>").appendTo("body").dialog({title:"Debug output",height:300}))),f){var d,e;for(d=0,e=arguments.length;e>d;d++)console.debug(arguments[d])}else b.apply(this,arguments)}}(),g.defaults=h.defaults,g}(P,H,c,g,a,I),L=function(a){var b=function(b){var c=a(b),d="",e=c.find("ErrorCode"),f=0;return e.length||(e=c.find("faultcode")),e.length?(e.each(function(){var b=a(this);"0x00000000"!==b.text()&&(f+=1,d+="("+f+") "+b.text()+": "+b.parent().children().not(b).text()+"\n")}),d=f+" error(s) encountered! \n"+d):""};return b}(P),M=function(a,b,c,d){var e=function(){var e=null,f=function(){return e.apply(this,arguments)};return f.defaults={webURL:"",cacheXML:!1,async:!0,completefunc:null,filter:null},e=function(e){var g,h=a.extend({},f.defaults,e);return h.webURL?"/"!==h.webURL.charAt(h.webURL.length-1)&&(h.webURL+="/"):h.webURL=c(),h.webURL+="_vti_bin/SiteData.asmx",h.cacheKey=h.webURL+"?"+[h.filter].join("|"),h.isCached=b.isCached(h.cacheKey),h.cacheXML&&h.isCached?(g=b(h.cacheKey),a.isFunction(h.completefunc)&&g.then(function(b,c,d){h.completefunc.call(a,c,d,b)}),g):(g=a.Deferred(function(c){h.isCached&&b.clear(h.cacheKey),a.ajax({type:"POST",cache:!1,async:h.async,url:h.webURL,contentType:"text/xml;charset=utf-8",dataType:"xml",data:'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetListCollection xmlns="http://schemas.microsoft.com/sharepoint/soap/"></GetListCollection></soap:Body></soap:Envelope>',complete:function(e,f){if("error"===f||d(e))return h.cacheXML&&b.clear(h.cacheKey),void c.rejectWith(a,[null,e,f]);var g=a(e.responseXML).find("_sList"),i=[];h.filter&&!a.isArray(h.filter)&&(h.filter=[h.filter]),g.each(function(){var b=a(this),c={};h.filter&&a.isArray(h.filter)&&-1===a.inArray(b.find("Title").text(),h.filter)&&-1===a.inArray(b.find("InternalName").text(),h.filter)||(b.children().each(function(){c[this.nodeName]=a(this).text()}),i.push(c))}),c.resolveWith(a,[i,e,f]),a.isFunction(h.completefunc)&&h.completefunc(e,f,i)}})}).promise(),h.cacheXML&&b(h.cacheKey,g),g)},f}();return e}(P,b,a,d),N=function(a,b,c,d){var e=function(){var e=null,f=null,g=function(){return null===f&&(f=this),e.apply(this,arguments)};return g.defaults={accountName:"",webURL:"",async:!0,cacheXML:!0,completefunc:null},e=function(e){var f,h=a.extend({},g.defaults,e);return h.webURL?"/"!==h.webURL.charAt(h.webURL.length-1)&&(h.webURL+="/"):h.webURL=c(),h.cacheKey=h.webURL+"/"+h.accountName,h.cacheXML===!0&&b.isCached(h.cacheKey)?(f=b.get(h.cacheKey),a.isFunction(h.completefunc)&&f.then(function(a,b,c){h.completefunc(b,c,a)}),f):(f=a.Deferred(function(c){a.ajax({type:"POST",cache:!1,async:h.async,url:h.webURL+"_vti_bin/UserProfileService.asmx",beforeSend:function(a){a.setRequestHeader("SOAPAction","http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/GetUserProfileByName")},contentType:"text/xml;charset=utf-8",dataType:"xml",data:'<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetUserProfileByName xmlns="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService"><AccountName>'+h.accountName+"</AccountName></GetUserProfileByName></soap:Body></soap:Envelope>",complete:function(e,f){var g=a(e.responseXML),i={};return"error"===f||d(g)?(h.cacheXML&&b.clear(h.cacheKey),c.rejectWith(a,[{},e,f]),void(a.isFunction(h.completefunc)&&h.completefunc(e,f,{}))):(g.find("PropertyData").each(function(){var b=a(this);i[b.find("Name").text()]=b.find("Value").text()||""}),c.resolveWith(a,[i,e,f]),void(a.isFunction(h.completefunc)&&h.completefunc.call(a,e,f,i)))}})}).promise(),h.cacheXML&&b(h.cacheKey,f),f)},g}();return e}(P,b,a,d),O=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){a.SPWidgets={defaults:{},version:"2.5.0",escapeXML:j.escape,unEscapeXML:j.unescape,fillTemplate:k,getCamlLogical:l,getSPVersion:m,parseDateString:n,parseLookupFieldValue:o,SPGetDateString:p,makeSameHeight:r,getRuntimeInfo:function(){function b(){return this.SPWidgets=a.SPWidgets.version,this.jQuery=a.fn.jquery||"?",this.jQueryUI="?",this.jQueryUICss="?",this}b.prototype.asString=function(){var a,b=this,c="";for(a in b)b.hasOwnProperty(a)&&(c+="[ "+a+" = "+b[a]+" ] ");return c};var c=new b,d=a('<div style="position:fixed;width:100px;left:-1000px;"/>').appendTo("body"),e="";try{c.jQueryUI=jQuery.ui.version}catch(f){}return e=d.css("background-image"),d.addClass("ui-widget-header"),d.css("background-image")!==e&&(c.jQueryUICss="loaded"),d.remove(),c},SPAPI:{getList:s,getListFormCollection:t,getListItems:u,getSiteListCollection:v,getSiteUrl:w,getUserProfile:x,resolvePrincipals:y,searchPrincipals:z,getNodesFromXml:q}},a.each({SPShowBoard:b,SPDateField:c,SPLookupField:d,pickSPUser:e,SPFilterPanel:f,SPControlUpload:g,SPGetMsgError:h,SPMsgHasError:i},function(b,c){a.fn[b]=function(){var a=Array.prototype.slice.call(arguments);return a.unshift(this),c.apply(c,a)},c.defaults&&(a.SPWidgets.defaults[b]=c.defaults)})}(P,n,s,y,D,G,K,L,d,w,i,u,I,q,v,p,f,j,c,e,g,M,a,N,B,A),function(a){var b=document,c="appendChild",d="styleSheet",e=b.createElement("style");e.type="text/css",b.getElementsByTagName("head")[0][c](e),e[d]?e[d].cssText=a:e[c](b.createTextNode(a))}('div.spwidget-board{width:100%;position:relative}div.spwidget-board div.spwidget-board-headers,div.spwidget-board div.spwidget-board-headers-cntr,div.spwidget-board div.spwidget-board-states-cntr,div.spwidget-board div.spwidget-board-states{width:100%}div.spwidget-board div.spwidget-board-state{width:49%;float:left;margin:0% .1%;padding:.2%;overflow:auto}div.spwidget-board div.spwidget-board-headers-cntr div.spwidget-board-state{font-weight:700;font-size:1.1em;overflow:hidden;word-wrap:break-word}div.spwidget-board div.spwidget-board-headers-cntr .spwidget-board-header-title{display:inline-block}div.spwidget-board div.spwidget-board-headers-cntr .spwidget-state-item-stat-cntr{display:inline-block;font-size:.8em;float:right}div.spwidget-board div.spwidget-board-headers-cntr .spwidget-item-stat{display:inline-block;min-width:2em;padding:0 .2em;text-align:center}div.spwidget-board div.spwidget-board-states div.spwidget-board-state{margin-bottom:1em;min-height:10em}div.spwidget-board div.spwidget-board-state div.spwidget-board-state-item{padding:.2em;margin:.5em .2em;font-weight:400;cursor:move;overflow:auto}div.spwidget-board div.spwidget-board-state-item div.spwidget-board-item-actions{margin-top:.2em;padding:.2em .5em;overflow:hidden}div.spwidget-board .spwidget-board-placeholder{height:3em}div.spwidget-board-settings{font-size:.8em;margin:.2em}div.spwidget-board-settings div.spwidget-board-column-list-cntr{z-index:5;position:absolute}div.spwidget-board-settings div.spwidget-board-column-list-cntr>div{padding:.2em}div.spwidget-board-settings div.spwidget-board-column-list-cntr>div:first-child,div.spwidget-board-settings div.spwidget-board-column-list-cntr>div:last-child{text-align:right}div.spwidget-board-settings div.spwidget-board-column-list{width:20em;height:17em;overflow:auto;position:relative}div.spwidget-board-settings div.spwidget-board-column-list-cntr .spwidget-board-msg{position:absolute;top:1px;left:1px;padding:.2em}div.spwidget-board-settings div.ui-state-default{position:relative}div.spwidget-board-settings div.spwidget-board-column-list>a{display:block;margin:.2em;padding:.2em}div.spwidget-board-settings div.spwidget-board-column-list>a>span.ui-icon{display:inline-block}div.spwidget-board .spwidget-states-3 div.spwidget-board-state{width:32.4%}div.spwidget-board .spwidget-states-4 div.spwidget-board-state{width:24%}div.spwidget-board .spwidget-states-5 div.spwidget-board-state{width:19.1%}div.spwidget-board .spwidget-states-6 div.spwidget-board-state{width:15.8%}div.spwidget-board .spwidget-states-7 div.spwidget-board-state{width:13.4%}div.spwidget-board .spwidget-states-8 div.spwidget-board-state{width:11.6%}div.spwidget-board .spwidget-states-9 div.spwidget-board-state{width:10.2%}div.spwidget-board .spwidget-states-10 div.spwidget-board-state{width:9.1%}.spwidget-date-cntr{display:inline-block;position:relative}.spwidget-date-cntr div.spwidget-date-input-cntr{position:relative}.spwidget-date-cntr input{width:99%}.spwidget-date-cntr img.ui-datepicker-trigger{display:block;position:absolute;right:2%;top:.3em}.spwidget-date-cntr .spwidgets-item-remove{color:red;font-size:xx-small;vertical-align:super;cursor:pointer}.spwidget-date-cntr div.spwidget-datetime-selector{padding:.5em;position:absolute;width:28em;z-index:1}.spwidget-date-cntr div.spwidget-datetime-selector div.ui-datepicker-inline{width:14em}.spwidget-date-cntr div.spwidget-datetime-selector div.spwidget-date-selector,.spwidget-date-cntr div.spwidget-datetime-selector div.spwidget-time-selector{float:left}.spwidget-date-cntr div.spwidget-selectors:before{content:"";display:table;line-height:0}.spwidget-date-cntr div.spwidget-selectors:after{content:"";display:table;line-height:0;clear:both}.spwidget-date-cntr div.spwidget-datetime-selector select.spwidget-hour,.spwidget-date-cntr div.spwidget-datetime-selector select.spwidget-min,.spwidget-date-cntr div.spwidget-datetime-selector select.spwidget-ampm{font-size:1.2em}.spwidget-date-cntr div.spwidget-time-selector{margin-left:.2em;width:11em}.spwidget-date-cntr div.spwidget-time-selector-cntr{padding:.2em}.spwidget-date-cntr div.spwidget-time-selector div.ui-widget-header{text-align:center;line-height:2em;margin-bottom:.5em}.spwidget-date-cntr .spwidget-time-hour,.spwidget-date-cntr .spwidget-time-min,.spwidget-date-cntr .spwidget-time-ampm{margin-top:.2em;padding:.2em}.spwidget-date-cntr .spwidget-time-selector-cntr select,.spwidget-date-cntr .spwidget-time-selector-cntr label{overflow:hidden;display:inline-block;font-weight:700}.spwidget-date-cntr .spwidget-time-selector-cntr select{width:4em}.spwidget-date-cntr .spwidget-time-selector-cntr label{width:5em;font-size:.9em}.spwidget-date-cntr .spwidget-inline div.spwidget-datetime-selector{position:relative;width:26em}.spwidget-btn-set{display:none;position:absolute;right:.2em;bottom:.2em}.spwidget-date-multiples-cntr .spwidget-btn-set{display:block}.spwidgets-lookup-cntr{position:relative;display:inline-block;zoom:1;*display:inline}.spwidgets-lookup-cntr .spwidgets-lookup-selected{-moz-appearance:textfield;-webkit-appearance:textfield;background-color:#fff;background-color:-moz-field;border:1px solid darkgray;box-shadow:1px 1px 1px 0 lightgray inset;font:-moz-field;font:-webkit-small-control;margin-top:5px;padding:2px 5px}.spwidgets-lookup-cntr .spwidgets-lookup-selected .spwidgets-item{display:inline-block;margin-left:.5em}.spwidgets-lookup-cntr .spwidgets-item:first-child{margin-left:0}.spwidgets-lookup-cntr .spwidgets-item-remove{color:red;font-size:xx-small;vertical-align:super;cursor:pointer}.spwidgets-lookup-cntr .spwidgets-lookup-input{margin:.2em 0;position:relative}.spwidgets-lookup-cntr .spwidgets-lookup-input input{width:99%}.spwidgets-lookup-cntr ul.ui-autocomplete{overflow:auto;z-index:1}.spwidgets-lookup-cntr div.spwidget-lookup-readyonly .spwidgets-lookup-selected{-moz-appearance:none;-webkit-appearance:none;background-color:transparent;border:none;box-shadow:none;font:inherit}.spwidgets-lookup-cntr div.spwidget-lookup-readyonly .spwidgets-item-remove{display:none}.spwidgets-lookup-cntr .spwidget-lookup-selector-showhide{background-repeat:no-repeat;background-image:url("/_layouts/images/bizdatacontentsource.gif");cursor:pointer;display:block;position:absolute;text-indent:-99999px;z-index:5;height:16px;width:16px;right:5px;top:.3em}.spwidgets-lookup-cntr div.spwidget-lookup-selector-cntr{display:none;position:absolute;left:0;z-index:10;padding:.2em;width:98%;font-size:.8em}.spwidgets-lookup-cntr div.spwidget-lookup-selector-cntr>.ui-state-default{padding:.2em;text-align:right}.spwidgets-lookup-cntr div.spwidget-lookup-selector-item-cntr{height:15em;overflow:auto;padding:.2em;font-size:1em}.spwidgets-lookup-cntr div.spwidget-lookup-selector-item-cntr .ui-state-highlight{padding:.5em;margin:1em .2em;text-align:center;font-size:1.1em;font-weight:700}.spwidgets-lookup-cntr div.spwidget-lookup-selector-item-cntr .spwidget-lookup-selector-next{cursor:pointer}.spwidgets-lookup-cntr div.spwidget-lookup-selector-item-cntr .spwidget-lookup-item{padding:.2em .5em;margin:.2em;cursor:pointer;font-weight:400}.pt-pickSPUser .pt-pickSPUser-selected .pt-pickSPUser-person{float:left;margin-left:.2em}.pt-pickSPUser .pt-pickSPUser-hint{font-size:.9em}.pt-pickSPUser div.pt-pickSPUser-input input.ui-autocomplete{width:99%}.pt-pickSPUser div.pt-pickSPUser-input ul.ui-autocomplete{z-index:1}.pt-pickSPUser .pt-pickSPUser-person-cntr{margin:.2em 0;padding:.2em;position:relative}.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-person-name{padding-right:2em}.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions{position:absolute;right:1px;top:1px;padding:.2em;display:none}.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions .pt-pickSPUser-person-action-links,.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions .pt-pickSPUser-person-action-links .tt-confirm-delete{float:right}.pt-pickSPUser .pt-pickSPUser-person-cntr.ui-state-hover .pt-pickSPUser-person-actions,.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions.tt-confirm,.pt-pickSPUser .pt-pickSPUser-person-cntr .pt-pickSPUser-person-actions a{display:block;float:right}.ui-autocomplete-loading{background:#fff url(\'/_layouts/images/loading.gif\') right center no-repeat}div.spwidget-filter{width:100%;position:relative}div.spwidget-filter .spwidget-date-cntr,div.spwidget-filter .spwidgets-lookup-cntr{display:block}div.spwidget-filter .spwidget-filter-column-cntr{overflow:auto;position:relative}div.spwidget-filter .spwidget-type-text input.spwidget-filter-input,div.spwidget-filter .spwidget-type-people input.ui-autocomplete-input,div.spwidget-filter div.spwidget-type-choice div.spwidget-filter-value-input{width:95%}div.spwidget-filter .spwidgets-lookup-cntr{width:96%}div.spwidget-filter .spwidget-date-cntr div.spwidget-date-input-cntr{width:97%}div.spwidget-filter div.spwidget-column{padding:.5em;margin:.5em;position:relative;border-bottom:1px solid darkgray;box-shadow:1px 1px 1px 0 lightgray inset}div.spwidget-filter div.spwidget-column-actions{position:absolute;right:1%;top:10%}div.spwidget-filter div.spwidget-column-actions a{display:block}div.spwidget-filter div.spwidget-column-sort-actions{display:none}div.spwidget-filter div.spwidget-has-sort-order div.spwidget-column-sort-actions{display:block}div.spwidget-filter div.spwidget-filter-type-cntr,div.spwidget-filter div.spwidget-column-actions a{opacity:.6;filter:alpha(opacity=60)}div.spwidget-filter div.spwidget-filter-type-cntr:hover,div.spwidget-filter div.spwidget-column-actions a:hover{opacity:1}div.spwidget-filter div.spwidget-filter-type-cntr{position:absolute;font-size:.8em;top:.6em;right:8%}div.spwidget-filter div.spwidget-filter-type-cntr select{text-overflow:ellipsis;width:5em}div.spwidget-filter div.spwidget-filter-value-cntr{width:96%}div.spwidget-filter div.spwidget-filter-value-cntr>label{display:block;padding:.2em;font-weight:700}div.spwidget-filter div.spwidget-column-dirty div.spwidget-filter-value-cntr>label{color:red}div.spwidget-filter .spwidget-tooltip{display:block;font-size:.8em;font-style:italic}div.spwidget-filter div.spwidgets-lookup-cntr div.spwidgets-lookup-selected>div.spwidgets-item{display:block;margin-left:0}div.spwidget-filter div.spwidget-type-choice div.spwidget-filter-value-input{max-height:6em;overflow:auto;-moz-appearance:textfield;-webkit-appearance:textfield;background-color:#fff;background-color:-moz-field;border:1px solid darkgray;box-shadow:1px 1px 1px 0 lightgray inset;font:-moz-field;font:-webkit-small-control;padding:2px 5px}div.spwidget-filter div.spwidget-type-choice div.spwidget-filter-value-input label{display:block;padding:.2em}div.spwidget-filter .spwidget-disabled{-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";filter:alpha(opacity=50);opacity:.5}div.spwidget-filter div.spwidget-filter-button-cntr{padding:.5em 4%;margin-top:.5em;text-align:right}.spcontrolupload .mainContainer{position:relative;display:block;height:4em}.spcontrolupload .iFrameWindow,.spcontrolupload .buttonPane{position:absolute;top:0;height:3em}.spcontrolupload .spwidget-success-cntr,.spcontrolupload .loadingOverlay{position:absolute;top:0;height:3em;width:100%}.spcontrolupload .buttonPane{left:0;width:10%;overflow:hidden;cursor:pointer}.spcontrolupload .buttonPane .upload_button{font-weight:700;font-size:1.1em;text-align:center;margin-top:.8em}.spcontrolupload .iFrameWindow{width:90%;left:10%;overflow:hidden}.spcontrolupload .iFrameWindow iframe{overflow:auto;width:100%;height:99%}.spcontrolupload .spwidget-show-full-form .iFrameWindow{overflow:auto;width:100%;margin:0;left:0;right:auto;z-index:5}.spcontrolupload .loadingOverlayMsg{font-size:1em;background-position:left top;background-repeat:no-repeat;background-image:url(\'/_layouts/images/loadingcirclests16.gif\');margin:.5em;padding-left:25px}.spcontrolupload .spwidget-success-cntr,.spcontrolupload .spwidget-error-cntr{display:none}.spcontrolupload div.spwidget-msg-cntr{margin:.5em .5em .5em 3em;font-size:1em;background-position:left top;background-repeat:no-repeat}.spcontrolupload .spwidget-close{color:red;font-size:xx-small;font-weight:700;vertical-align:super;cursor:pointer}.spcontrolupload .spwidget-success-cntr div.spwidget-msg-cntr{background-image:url(\'/_layouts/images/STS_ListItem_43216.gif\');padding-left:30px}.spcontrolupload .spwidget-error-cntr{bottom:-1.5em;left:0;width:100%;position:absolute}.spcontrolupload-dev-mode .iFrameWindow{overflow:auto!important;height:auto!important;z-index:5!important}.spcontrolupload-dev-mode .iFrameWindow iframe{overflow:scroll!important}')})}();
//# sourceMappingURL=jquery.SPWidgets.min.js.map